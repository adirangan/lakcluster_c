function [xc__sum,xc__dat,tot_n_dat] = helper_auc_AXXX_ver1(aucname,xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);
%{

  % AAAA_sym;
  %!scp -p dir_lakcluster_test_AAAA_sym/xx_out_AAAA_sym_ver0.txt rangan@access1.cims.nyu.edu:/data/rangan/dir_bcc/dir_code_022316/dir_lakcluster_test_AAAA_sym/xx_out_AAAA_sym_ver0.txt ;
  print('Warning! old version');
  nbins = 1; N_ra = 2.^[6:13]; X_factor_ra = [0.40:0.0125:0.60]; X_esm_ra = 10.^[-3:0.25:1]; gamma_ra = [0.01]; B_ra = [0];
  rng_num_ra = 1:64; X_factor_d_ra = floor(100*X_factor_ra); X_esm_d_ra = 10 + floor(-10*log10(X_esm_ra)); gamma_d_ra = floor(10*gamma_ra); ver_num=0;
  xcra = 8 + [1,2,3]; xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum,xc__dat,tot_n_dat] = helper_auc_AXXX_ver1('./dir_lakcluster_test_AAAA_sym/xx_out_AAAA_sym_ver1.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);

  % AAAA gamma ;
  %if strcmp(test_string,'lakcluster_test_AAAA_gamma'); 
  %test_string = 'lakcluster_test_AAAA';
  print('Warning! old version');
  nbins = 1; N_ra = 2.^[10]; X_factor_ra = [0.45:0.0125:0.65]; X_esm_ra = 10.^[-3:0.25:1]; gamma_ra = 0.5.^[0:7]; B_ra = [0];
  rng_num_ra = 1:64; X_factor_d_ra = floor(100*X_factor_ra); X_esm_d_ra = 10 + floor(-10*log10(X_esm_ra)); gamma_d_ra = floor(10*gamma_ra); ver_num=4;
  %end;%if strcmp(test_string,'lakcluster_test_AAAA_gamma'); 
  xcra = 8 + [1,2]; xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum,xc__dat,tot_n_dat] = helper_auc_AXXX_ver1('./dir_lakcluster_test_AAAA/xx_out_AAAA_gXX.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);

  % New AAAA;
  %!cat dir_lakcluster_test_AAAA/xx_out.txt.pt??? >> dir_lakcluster_test_AAAA/xx_out.txt ;
  %!scp -p dir_lakcluster_test_AAAA/xx_out.txt rangan@access1.cims.nyu.edu:/data/rangan/dir_bcc/dir_code_022316/dir_lakcluster_test_AAAA/xx_out.txt ;
  print('Warning! old version');
  nbins = 1; 
  N_ra = 2.^[6:13];
  X_factor_ra = [0.45:0.0125:0.65]; 
  X_esm_ra = 10.^[-3:0.25:1];
  gamma_ra = [0.01];%gamma_ra = [0.00,0.05,0.15,0.50];
  B_ra = [0];%B_ra = [0,4,8,16];
  rng_num_ra = 1:64; ver_num=4;
  xcra = 8 + [1,2]; % xx_ra = [auc_r, auc_c] ;
  xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum,xc__dat,tot_n_dat] = helper_auc_AXXX_ver1('./dir_lakcluster_test_AAAA/xx_out_AAAA_g01.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);
  figure(1); print('-depsc','dir_lakcluster_test_AAAA/lakcluster_test_AAAA_c_r_ver0.eps');
  figure(2); print('-depsc','dir_lakcluster_test_AAAA/lakcluster_test_AAAA_r_c_ver0.eps');
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% ;
  % Attempt to reorganize data? ;
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% ;
  g1_esm_ra=zeros(size(X_esm_ra)); for n_X_esm=1:length(X_esm_ra); X_esm=X_esm_ra(n_X_esm); g1_esm_ra(n_X_esm) = tutorial_g1em(X_esm); end;
  MX_ra=zeros(length(N_ra),length(X_factor_ra)); for n_N=1:length(N_ra);for n_X_factor=1:length(X_factor_ra); N=N_ra(n_N); X_factor = X_factor_ra(n_X_factor); MX_ra(n_N,n_X_factor) = ceil(N.^(X_factor)); end;end;
  nxc=1;
  cra = colormap('jet');ncra = size(cra,1);
  cla;hold on;
  for n_N = 1:length(N_ra); for n_X_factor = 1:length(X_factor_ra); for n_X_esm = 1:length(X_esm);
  n_gamma=1;n_B=1;%for n_gamma = 1:length(gamma_ra); for n_B = 1:length(B_ra);
  N = N_ra(n_N);
  sz = MX_ra(n_N,n_X_factor);
  gz = g1_esm_ra(n_X_esm);
  iz = (2*gz-1).*sz.^3./(sqrt(2*N.^3));
  %for n_rng_num = 1:length(rng_num_ra); plot(iz,xc__dat(n_N,n_X_factor,n_X_esm,n_gamma,n_B,n_rng_num,nxc),'o','Color',cra(max(1,min(ncra,floor(ncra*n_N/length(N_ra)))),:)); end;
  plot(iz,xc__sum(n_N,n_X_factor,n_X_esm,n_gamma,n_B,nxc),'o','Color',cra(max(1,min(ncra,floor(ncra*n_N/length(N_ra)))),:));
  %end;end;% B,gamma;
  end;end;end;% X_esm,X_factor,N;
  hold off;
  xlim([0,7]);ylim([0.25,1]);
  % can also try to plot in terms of beta (m^2/sqrt(m));
  beta_d_ = linspace(0.25,1.75,1024);
  figure;clf;hold on;
  for ne=1:length(X_esm_ra(1));
  for nN=1:length(N_ra);
  N = N_ra(nN);
  beta_N_ = beta_d_*sqrt(N_ra(nN));
  tmp_x = ceil(N.^(X_factor_ra));
  tmp_y = squeeze(xc__sum(nN,:,ne,1,1,1));
  tmp_x_u = unique(tmp_x);
  tmp_y_u = zeros(size(tmp_x_u));
  for nx=1:length(tmp_x_u);
  tmp_y_u(nx) = mean(tmp_y(find(tmp_x==tmp_x_u(nx))));
  end;%for nx=1:length(tmp_x_u);
  plot(beta_d_,interp1(tmp_x_u,tmp_y_u,beta_N_),'k-');
  end;% for nN=1:length(N_ra);
  end;% for ne=1:length(X_esm_ra(1));
  hold off;

  % new AZZA ;
  % first bicluster in A only, second bicluster in both A and Z (same size in A, matched size in Z) ;
  % !scp -p dir_lakcluster_test_AZZA/xx_out_AZZA_g01.txt rangan@access1.cims.nyu.edu:/data/rangan/dir_bcc/dir_code_022316/dir_lakcluster_test_AZZA/ ;
  print('Warning! old version');
  nbins = 1; N_ra = 2.^[6:13]; X_factor_ra = [0.45:0.0125:0.65]; X_esm_ra = 10.^[-3:0.25:1]; gamma_ra = [0.01]; B_ra = [0];
  rng_num_ra = 1:64; X_factor_d_ra = floor(100*X_factor_ra); X_esm_d_ra = 10 + floor(-10*log10(X_esm_ra)); gamma_d_ra = floor(10*gamma_ra); ver_num=1;
  xcra = 8 + [3,6]; % xx_ra = [auc_r1,auc_c1,0.5*(auc_r1+auc_c1),auc_r2,auc_c2,0.5*(auc_r2+auc_c2)];
  xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum,xc__dat,tot_n_dat] = helper_auc_AXXX_ver1('./dir_lakcluster_test_AZZA/xx_out_AZZA_g01.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);
  figure(1); print('-depsc','dir_lakcluster_test_AZZA/lakcluster_test_AZZA_x0_ver0.eps');
  figure(2); print('-depsc','dir_lakcluster_test_AZZA/lakcluster_test_AZZA_x1_ver0.eps');      

  % AZWY 121216d ;
  % !scp -p dir_lakcluster_test_AZWY/xx_out_AZWY_121216d.txt rangan@access1.cims.nyu.edu:/data/rangan/dir_bcc/dir_code_022316/dir_lakcluster_test_AZWY/ ;
  print('Warning! old version');
  nbins = 1; N_ra = 2.^[6:13]; X_factor_ra = [0.45:0.0125:0.65]; X_esm_ra = 10.^[-3:0.25:1]; gamma_ra = [0.01]; B_ra = [0];
  rng_num_ra = 1:64; X_factor_d_ra = floor(100*X_factor_ra); X_esm_d_ra = 10 + floor(-10*log10(X_esm_ra)); gamma_d_ra = floor(10*gamma_ra); ver_num=1;
  xcra = 8 + [1]; xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum,xc__dat,tot_n_dat] = helper_auc_AXXX_ver1('./dir_lakcluster_test_AZWY/xx_out_AZWY_121216d.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);
  figure(1); print('-depsc','dir_lakcluster_test_AZWY/lakcluster_test_AZWY_x0_ver0.eps');
  xcra = 8 + [4,7]; xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum,xc__dat,tot_n_dat] = helper_auc_AXXX_ver1('./dir_lakcluster_test_AZWY/xx_out_AZWY_121216d.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);
  figure(3); print('-depsc','dir_lakcluster_test_AZWY/lakcluster_test_AZWY_x12_ver0.eps');
  xcra = 8 + [10]; xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum,xc__dat,tot_n_dat] = helper_auc_AXXX_ver1('./dir_lakcluster_test_AZWY/xx_out_AZWY_121216d.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);
  figure(1); print('-depsc','dir_lakcluster_test_AZWY/lakcluster_test_AZWY_x3_ver0.eps');
  xcra = 8 + [4,7,10]; xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum,xc__dat,tot_n_dat] = helper_auc_AXXX_ver1('./dir_lakcluster_test_AZWY/xx_out_AZWY_121216d.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);
  figure(4); print('-depsc','dir_lakcluster_test_AZWY/lakcluster_test_AZWY_x123_ver0.eps');

  % AAYY;
  % first bicluster in A only, second bicluster in both A and Y (same size in A, spans all of Y) ;
  print('Warning! old version');
  N_ra = 2.^[6:13];
  X_factor_ra = [0.45:0.025:0.65];
  X_esm_ra = 10.^[-3:0.5:1];
  gamma_ra = [0.01,0.05,0.15,0.50];%gamma_ra = [0.00,0.05,0.15,0.50];
  B_ra = [0];%B_ra = [0,4,8,16];
  rng_num_ra = 1:16;
  xcra = 8 + [3,6]; % xx_ra = [auc_r1,auc_c1,0.5*(auc_r1+auc_c1),auc_r2,auc_c2,0.5*(auc_r2+auc_c2)];
  xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum,xc__dat,tot_n_dat] = helper_auc_AXXX_ver1('./dir_lakcluster_test_AAYY/xx_out.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);

  % new AATAA;
  % first bicluster balanced across T, second bicluster (1.5x size) pos T only, third bicluster (2x size) neg T only ;
  % !scp -p dir_lakcluster_test_AATAA/xx_out_AATAA_g01.txt rangan@access1.cims.nyu.edu:/data/rangan/dir_bcc/dir_code_022316/dir_lakcluster_test_AATAA/ ;
  print('Warning! old version');
  nbins = 1; N_ra = 2.^[6:13]; X_factor_ra = [0.45:0.0125:0.65]; X_esm_ra = 10.^[-3:0.25:1]; gamma_ra = [0.01]; B_ra = [0];
  rng_num_ra = 1:64; X_factor_d_ra = floor(100*X_factor_ra); X_esm_d_ra = 10 + floor(-10*log10(X_esm_ra)); gamma_d_ra = floor(10*gamma_ra); ver_num=2;
  xcra = 8 + [3,6,9]; 
  xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  %[xc__sum,xc__dat,tot_n_dat] = helper_auc_AXXX_ver1('./dir_lakcluster_test_AATAA/xx_out_AATAA_g01_ver4.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra); % nmds=2 and u1 = 1; u2 = 2; u3 = 4; 
  [xc__sum,xc__dat,tot_n_dat] = helper_auc_AXXX_ver1('./dir_lakcluster_test_AATAA/xx_out_AATAA_g01_ver10.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra); % nmds=2 and u1 = 1; u2 = 0; u3 = 1;

  % !scp -p dir_lakcluster_test_AATAA/xx_out_AATAA_111716.txt rangan@access1.cims.nyu.edu:/data/rangan/dir_bcc/dir_code_022316/dir_lakcluster_test_AATAA/ ;
  print('Warning! old version');
  nbins = 1; N_ra = 2.^[6:13]; X_factor_ra = [0.45:0.0125:0.65]; X_esm_ra = 10.^[-3:0.25:1]; gamma_ra = [0.01]; B_ra = [0];
  rng_num_ra = 1:64; X_factor_d_ra = floor(100*X_factor_ra); X_esm_d_ra = 10 + floor(-10*log10(X_esm_ra)); gamma_d_ra = floor(10*gamma_ra); ver_num=2;
  xcra = 8 + [3]; 
  %xcra = 8 + [9]; 
  xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum,xc__dat,tot_n_dat] = helper_auc_AXXX_ver1('./dir_lakcluster_test_AATAA/xx_out_AATAA_111716.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra); % nmds=2 and u1 = 1; u2 = 0; u3 = 2; 
  %!scp -p dir_lakcluster_test_AATAA/xx_out_AATAA_112116.txt rangan@access1.cims.nyu.edu:/data/rangan/dir_bcc/dir_code_022316/dir_lakcluster_test_AATAA/ ;
  nbins = 1; N_ra = 2.^[6:13]; X_factor_ra = [0.45:0.0125:0.65]; X_esm_ra = 10.^[-3:0.25:1]; gamma_ra = [0.01]; B_ra = [0];
  rng_num_ra = 1:64; X_factor_d_ra = floor(100*X_factor_ra); X_esm_d_ra = 10 + floor(-10*log10(X_esm_ra)); gamma_d_ra = floor(10*gamma_ra); ver_num=2;
  %xcra = 8 + [3,6,9]; 
  xcra = 8 + [6,9]; 
  xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum,xc__dat,tot_n_dat] = helper_auc_AXXX_ver1('./dir_lakcluster_test_AATAA/xx_out_AATAA_112116.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra); % nmds=2 and u1 = 1; u2 = 2; u3 = 4; 

  % uAZZA;
  % This case considers four clusters embedded within a data-set possessing cases and controls, ;
  % as well as two categorical covariate categories. ;
  % The first cluster straddles both covariate categories within the cases, ;
  % whereas the next two clusters are each restricted to a single category within the cases. ;
  % The fourth cluster is even larger and straddles both covariates, but also straddles cases and controls. ;
  % Here we make nrows_Z_(nbins) twice as large as nrows_A_(nbins) (i.e., twice as many controls as cases). ;
  print('Warning! old version');
  N_ra = 2.^[6:13];
  X_factor_ra = [0.45:0.025:0.65];
  X_esm_ra = 10.^[-3:0.5:1];
  gamma_ra = [0.01,0.05,0.15,0.50];%gamma_ra = [0.00,0.05,0.15,0.50];
  B_ra = [0];%B_ra = [0,4,8,16];
  rng_num_ra = 1:16;
  xcra = 8 + [1,2,3,4,5,6,7,8,9,10]; % xx_ra = [auc_c_1x,auc_r_11,auc_r_12,auc_c_2,auc_r_2,auc_c_3,auc_r_3,auc_c_4x,auc_r_41,auc_r_42];
  xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum,xc__dat,tot_n_dat] = helper_auc_AXXX_ver1('./dir_lakcluster_test_uAZZA/xx_out.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);

  % new uAZZA;
  % This case considers four clusters embedded within a data-set possessing cases and controls, ;
  % as well as two categorical covariate categories. ;
  % The first cluster straddles both covariate categories within the cases, ;
  % whereas the next two clusters are each restricted to a single category within the cases. ;
  % The fourth cluster is even larger and straddles both covariates, but also straddles cases and controls. ;
  % Here we make nrows_Z_(nbins) twice as large as nrows_A_(nbins) (i.e., twice as many controls as cases). ;
  print('Warning! old version');
  N_ra = 2.^[6:13]; X_factor_ra = [0.45:0.0125:0.65]; X_esm_ra = 10.^[-3:0.25:1]; gamma_ra = [0.01]; B_ra = [0];
  rng_num_ra = 1:64; X_factor_d_ra = floor(100*X_factor_ra); X_esm_d_ra = 10 + floor(-10*log10(X_esm_ra)); gamma_d_ra = floor(10*gamma_ra); ver_num=2;
  %xcra = 8 + [1,2,3,4,5,6,7,8,9,10]; % xx_ra = [auc_c_1x,auc_r_11,auc_r_12,auc_c_2,auc_r_2,auc_c_3,auc_r_3,auc_c_4x,auc_r_41,auc_r_42];
  xcra = 8 + [1,2,3]; % xx_ra = [auc_c_1x,auc_r_11,auc_r_12,auc_c_2,auc_r_2,auc_c_3,auc_r_3,auc_c_4x,auc_r_41,auc_r_42];
  xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum,xc__dat,tot_n_dat] = helper_auc_AXXX_ver1('./dir_lakcluster_test_uAZZA/xx_out_uAZZA_g01_ver0.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);

  % uAAAA;
  print('Warning! old version');
  N_ra = 2.^[6:13]; X_factor_ra = [0.45:0.0125:0.65]; X_esm_ra = 10.^[-3:0.25:1]; gamma_ra = [0.01]; B_ra = [0];
  rng_num_ra = 1:64; X_factor_d_ra = floor(100*X_factor_ra); X_esm_d_ra = 10 + floor(-10*log10(X_esm_ra)); gamma_d_ra = floor(10*gamma_ra); ver_num=0;
  xcra = 8 + [1,2,3,4,5,6,7]; % xx_ra = [auc_c_1x,auc_r_11,auc_r_12,auc_c_2,auc_r_2,auc_c_3,auc_r_3];
  xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum,xc__dat,tot_n_dat] = helper_auc_AXXX_ver1('./dir_lakcluster_test_uAAAA/xx_out_uAAAA_g01_ver0.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);
  
  % new uAAAA;
  %!scp -p dir_lakcluster_test_uAAAA/xx_out_uAAAA_g01_ver2.txt rangan@access1.cims.nyu.edu:/data/rangan/dir_bcc/dir_code_022316/dir_lakcluster_test_uAAAA/ ;
  print('Warning! old version');
  nbins = 2; N_ra = 2.^[6:13]; X_factor_ra = [0.45:0.0125:0.65]; X_esm_ra = 10.^[-3:0.25:1]; gamma_ra = [0.01]; B_ra = [0];
rng_num_ra = 1:64; X_factor_d_ra = floor(100*X_factor_ra); X_esm_d_ra = 10 + floor(-10*log10(X_esm_ra)); gamma_d_ra = floor(10*gamma_ra); ver_num=0;
  xcra = 8 + [1,2,3]; % xx_ra = [auc_c_1x,auc_r_11,auc_r_12,auc_c_2,auc_r_2,auc_c_3,auc_r_3];
  xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum,xc__dat,tot_n_dat] = helper_auc_AXXX_ver1('./dir_lakcluster_test_uAAAA/xx_out_uAAAA_g01_ver2.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);
  figure(4); print('-depsc','dir_lakcluster_test_uAAAA/lakcluster_test_uAAAA_x123_ver0.eps');
  xcra = 8 + [4,5,6,7]; % xx_ra = [auc_c_1x,auc_r_11,auc_r_12,auc_c_2,auc_r_2,auc_c_3,auc_r_3];
  xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum,xc__dat,tot_n_dat] = helper_auc_AXXX_ver1('./dir_lakcluster_test_uAAAA/xx_out_uAAAA_g01_ver2.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);
  figure(5); print('-depsc','dir_lakcluster_test_uAAAA/lakcluster_test_uAAAA_x4567_ver0.eps');

  % auc uAZSZA;
  % This case considered a single cluster within a single A relative to a Z (of twice the size) ;
  %!cat dir_aucward_test_uAZSZA/xx_out.txt.pt??? >> dir_aucward_test_uAZSZA/xx_out.txt ;
  %!scp -p dir_aucward_test_uAZSZA/xx_out.txt rangan@access1.cims.nyu.edu:/data/rangan/dir_bcc/dir_code_022316/dir_aucward_test_uAZSZA/xx_out.txt ;
  print('Warning! old version');
  nbins = 1; N_ra = 2.^[6:13]; X_factor_ra = [0.45:0.0125:0.65]; X_esm_ra = 10.^[-3:0.25:1]; gamma_ra = [0.01]; B_ra = [0];
  rng_num_ra = 1:128; X_factor_d_ra = floor(100*X_factor_ra); X_esm_d_ra = 10 + floor(-10*log10(X_esm_ra)); gamma_d_ra = floor(10*gamma_ra); ver_num=1;
  xcra = 8 + [1,2]; % xx_ra = [auc_r, auc_c] ;
  xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum,xc__dat,tot_n_dat] = helper_auc_AXXX_ver1('./dir_aucward_test_uAZSZA/xx_out.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);
  figure(1); print('-depsc','dir_aucward_test_uAZSZA/aucward_test_uAZSZA_c_r_ver0.eps');
  figure(2); print('-depsc','dir_aucward_test_uAZSZA/aucward_test_uAZSZA_r_c_ver0.eps');

  % dexcluster uAZSZA;
  %!scp -p dir_dexcluster_test_uAZSZA/xx_out_dexcluster_uAZSZA_ver4.txt rangan@access1.cims.nyu.edu:/data/rangan/dir_bcc/dir_code_022316/dir_dexcluster_test_uAZSZA/xx_out_dexcluster_uAZSZA_ver4.txt ;
  print('Warning! old version');
  nbins = 1; N_ra = 2.^[6:1:13]; X_factor_ra = [0.45:0.0125:0.65]; X_esm_ra = 10.^[-3:0.25:1]; gamma_ra = [0.01]; B_ra = [0];
  rng_num_ra = 1:128; X_factor_d_ra = floor(100*X_factor_ra); X_esm_d_ra = 10 + floor(-10*log10(X_esm_ra)); gamma_d_ra = floor(10*gamma_ra); ver_num=0;
  fig_base = './dir_dexcluster_test_uAZSZA/dexcluster_test_uAZSZA';
  fname = './dir_dexcluster_test_uAZSZA/xx_out_dexcluster_uAZSZA_ver4.txt';
  xcra = 8 + [1]; xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum_1,xc__dat_1,tot_n_dat_1] = helper_auc_AXXX_ver1(fname,xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);
  figure(1); print('-depsc',sprintf('%s_x0_ver4.eps',fig_base)); print('-djpeg',sprintf('%s_x0_ver4.jpg',fig_base));

  % dexcluster uADZSZDA;
  % cat dir_dexcluster_test_uADZSZDA_Ireq1/xx_out.txt.pt??? > dir_dexcluster_test_uADZSZDA_Ireq1/xx_out_dexcluster_test_uADZSZDA_Ireq1.txt ;
  % scp -p dir_dexcluster_test_uADZSZDA_Ireq1/xx_out_dexcluster_test_uADZSZDA_Ireq1.txt rangan@access1.cims.nyu.edu:/data/rangan/dir_bcc/dir_code_081717/dir_dexcluster_test_uADZSZDA_Ireq1/xx_out_dexcluster_test_uADZSZDA_Ireq1.txt ;
  % cat dir_dexcluster_test_uADZSZDA_Ireq2/xx_out.txt.pt??? > dir_dexcluster_test_uADZSZDA_Ireq2/xx_out_dexcluster_test_uADZSZDA_Ireq2.txt ;
  % scp -p dir_dexcluster_test_uADZSZDA_Ireq2/xx_out_dexcluster_test_uADZSZDA_Ireq2.txt rangan@access1.cims.nyu.edu:/data/rangan/dir_bcc/dir_code_081717/dir_dexcluster_test_uADZSZDA_Ireq2/xx_out_dexcluster_test_uADZSZDA_Ireq2.txt ;
  % cat dir_dexcluster_test_uADZSZDA_Ireq3/xx_out.txt.pt??? > dir_dexcluster_test_uADZSZDA_Ireq3/xx_out_dexcluster_test_uADZSZDA_Ireq3.txt ;
  % scp -p dir_dexcluster_test_uADZSZDA_Ireq3/xx_out_dexcluster_test_uADZSZDA_Ireq3.txt rangan@access1.cims.nyu.edu:/data/rangan/dir_bcc/dir_code_081717/dir_dexcluster_test_uADZSZDA_Ireq3/xx_out_dexcluster_test_uADZSZDA_Ireq3.txt ;
  nbins = 3; N_ra = 2.^[11]; X_factor_ra = [0.45:0.0125:0.65]; X_esm_ra = 10.^[-3:0.25:1]; gamma_ra = [0.01]; B_ra = [32];
  rng_num_ra = 1:32; X_factor_d_ra = floor(100*X_factor_ra); X_esm_d_ra = 10 + floor(-10*log10(X_esm_ra)); gamma_d_ra = floor(10*gamma_ra); ver_num=7; 
  tab=2;
  if tab==1;
  fig_base = './dir_dexcluster_test_uADZSZDA_Ireq1/dexcluster_test_uADZSZDA_Ireq1';
  fname = './dir_dexcluster_test_uADZSZDA_Ireq1/xx_out_dexcluster_test_uADZSZDA_Ireq1.txt';
  elseif tab==2;
  fig_base = './dir_dexcluster_test_uADZSZDA_Ireq2/dexcluster_test_uADZSZDA_Ireq2';
  fname = './dir_dexcluster_test_uADZSZDA_Ireq2/xx_out_dexcluster_test_uADZSZDA_Ireq2.txt';
  elseif tab==3;
  fig_base = './dir_dexcluster_test_uADZSZDA_Ireq3/dexcluster_test_uADZSZDA_Ireq3';
  fname = './dir_dexcluster_test_uADZSZDA_Ireq3/xx_out_dexcluster_test_uADZSZDA_Ireq3.txt';
  end;% tab;
  xcra = 8 + [1]; xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum_1,xc__dat_1,tot_n_dat_1] = helper_auc_AXXX_ver1(fname,xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);
  figure(1); print('-depsc',sprintf('%s_x0_ver0.eps',fig_base)); print('-djpeg',sprintf('%s_x0_ver0.jpg',fig_base));
  pause(1); close all;
  xcra = 8 + 1 + [3:3:9]; xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum_1,xc__dat_1,tot_n_dat_1] = helper_auc_AXXX_ver1(fname,xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);
  figure(4); print('-depsc',sprintf('%s_x123_ver0.eps',fig_base)); print('-djpeg',sprintf('%s_x123_ver0.jpg',fig_base));
  pause(1); close all;
  xcra = 8 + 1 + [12:3:18]; xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum_1,xc__dat_1,tot_n_dat_1] = helper_auc_AXXX_ver1(fname,xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);
  figure(4); print('-depsc',sprintf('%s_x456_ver0.eps',fig_base)); print('-djpeg',sprintf('%s_x456_ver0.jpg',fig_base));
  pause(1); close all;

  % lakcluster uADZSZDA;
  % cat dir_lakcluster_test_uADZSZDA_Ireq1/xx_out.txt.pt??? > dir_lakcluster_test_uADZSZDA_Ireq1/xx_out_lakcluster_test_uADZSZDA_Ireq1.txt ;
  % scp -p dir_lakcluster_test_uADZSZDA_Ireq1/xx_out_lakcluster_test_uADZSZDA_Ireq1.txt rangan@access1.cims.nyu.edu:/data/rangan/dir_bcc/dir_code_081717/dir_lakcluster_test_uADZSZDA_Ireq1/xx_out_lakcluster_test_uADZSZDA_Ireq1.txt ;
  % cat dir_lakcluster_test_uADZSZDA_Ireq2/xx_out.txt.pt??? > dir_lakcluster_test_uADZSZDA_Ireq2/xx_out_lakcluster_test_uADZSZDA_Ireq2.txt ;
  % scp -p dir_lakcluster_test_uADZSZDA_Ireq2/xx_out_lakcluster_test_uADZSZDA_Ireq2.txt rangan@access1.cims.nyu.edu:/data/rangan/dir_bcc/dir_code_081717/dir_lakcluster_test_uADZSZDA_Ireq2/xx_out_lakcluster_test_uADZSZDA_Ireq2.txt ;
  % cat dir_lakcluster_test_uADZSZDA_Ireq3/xx_out.txt.pt??? > dir_lakcluster_test_uADZSZDA_Ireq3/xx_out_lakcluster_test_uADZSZDA_Ireq3.txt ;
  % scp -p dir_lakcluster_test_uADZSZDA_Ireq3/xx_out_lakcluster_test_uADZSZDA_Ireq3.txt rangan@access1.cims.nyu.edu:/data/rangan/dir_bcc/dir_code_081717/dir_lakcluster_test_uADZSZDA_Ireq3/xx_out_lakcluster_test_uADZSZDA_Ireq3.txt ;
  nbins = 3; N_ra = 2.^[11]; X_factor_ra = [0.45:0.0125:0.65]; X_esm_ra = 10.^[-3:0.25:1]; gamma_ra = [0.01]; B_ra = [32];
  rng_num_ra = 1:8; X_factor_d_ra = floor(100*X_factor_ra); X_esm_d_ra = 10 + floor(-10*log10(X_esm_ra)); gamma_d_ra = floor(10*gamma_ra); ver_num=7; 
  tab=2;
  if tab==1;
  fig_base = './dir_lakcluster_test_uADZSZDA_Ireq1/lakcluster_test_uADZSZDA_Ireq1';
  fname = './dir_lakcluster_test_uADZSZDA_Ireq1/xx_out_lakcluster_test_uADZSZDA_Ireq1.txt';
  elseif tab==2;
  fig_base = './dir_lakcluster_test_uADZSZDA_Ireq2/lakcluster_test_uADZSZDA_Ireq2';
  fname = './dir_lakcluster_test_uADZSZDA_Ireq2/xx_out_lakcluster_test_uADZSZDA_Ireq2.txt';
  elseif tab==3;
  fig_base = './dir_lakcluster_test_uADZSZDA_Ireq3/lakcluster_test_uADZSZDA_Ireq3';
  fname = './dir_lakcluster_test_uADZSZDA_Ireq3/xx_out_lakcluster_test_uADZSZDA_Ireq3.txt';
  end;% tab;
  xcra = 8 + [1]; xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum_1,xc__dat_1,tot_n_dat_1] = helper_auc_AXXX_ver1(fname,xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);
  figure(1); print('-depsc',sprintf('%s_x0_ver0.eps',fig_base)); print('-djpeg',sprintf('%s_x0_ver0.jpg',fig_base));
  close all;
  xcra = 8 + 1 + [3:3:9]; xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum_1,xc__dat_1,tot_n_dat_1] = helper_auc_AXXX_ver1(fname,xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);
  figure(4); print('-depsc',sprintf('%s_x123_ver0.eps',fig_base)); print('-djpeg',sprintf('%s_x123_ver0.jpg',fig_base));
  pause(1); close all;
  xcra = 8 + 1 + [12:3:18]; xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  pause(1); close all;
  [xc__sum_1,xc__dat_1,tot_n_dat_1] = helper_auc_AXXX_ver1(fname,xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);
  figure(4); print('-depsc',sprintf('%s_x456_ver0.eps',fig_base)); print('-djpeg',sprintf('%s_x456_ver0.jpg',fig_base));
  pause(1); close all;

  % ADAADA;
  % 9 basic clusters embedded in 3-level sparse An{nbins}; X_{ns,nc} is of sparsity class ns (i.e., 0.125, 0.5, 0.875) within background sparsity nc ;
  print('Warning! old version');
  N_ra = 2.^[6:13];
  X_factor_ra = [0.45:0.025:0.65];
  X_esm_ra = 10.^[-3:0.5:1];
  gamma_ra = [0.01,0.05,0.15,0.50];%gamma_ra = [0.00,0.05,0.15,0.50];
  B_ra = [0];%B_ra = [0,4,8,16];
  rng_num_ra = 1:16;
  xcra = 8 + 9 + 9 + [1:9]; %XRout;
  % xcra = 8 + [1:9]; %ARout;
  %{
    % compares each X_pr only to the other indices which are not in other biclusters ;
    ARout = [   get_auc((A_pr_x),(X_pr_{1,1})) , get_auc((A_pr_x),(X_pr_{1,2})) , get_auc((A_pr_x),(X_pr_{1,3})) ;...
		get_auc((A_pr_x),(X_pr_{2,1})) , get_auc((A_pr_x),(X_pr_{2,2})) , get_auc((A_pr_x),(X_pr_{2,3})) ;...
		get_auc((A_pr_x),(X_pr_{3,1})) , get_auc((A_pr_x),(X_pr_{3,2})) , get_auc((A_pr_x),(X_pr_{3,3})) ;...
		 ];
    ACout = [   get_auc((A_pc_x),(X_pc_{1,1})) , get_auc((A_pc_x),(X_pc_{1,2})) , get_auc((A_pc_x),(X_pc_{1,3})) ;...
		get_auc((A_pc_x),(X_pc_{2,1})) , get_auc((A_pc_x),(X_pc_{2,2})) , get_auc((A_pc_x),(X_pc_{2,3})) ;...
		get_auc((A_pc_x),(X_pc_{3,1})) , get_auc((A_pc_x),(X_pc_{3,2})) , get_auc((A_pc_x),(X_pc_{3,3})) ;...
		 ];
    % compares each X_pr to each other X_pr in the same sparsity class;
    XRout = [   get_auc((X_pr_{1,1}),(X_pr_{2,1})) , get_auc((X_pr_{1,1}),(X_pr_{3,1})) , get_auc((X_pr_{2,1}),(X_pr_{3,1})) ;...
		get_auc((X_pr_{1,2}),(X_pr_{2,2})) , get_auc((X_pr_{1,2}),(X_pr_{3,2})) , get_auc((X_pr_{2,2}),(X_pr_{3,2})) ;...
		get_auc((X_pr_{1,3}),(X_pr_{2,3})) , get_auc((X_pr_{1,3}),(X_pr_{3,3})) , get_auc((X_pr_{2,3}),(X_pr_{3,3})) ;...
		 ];
    XCout = [   get_auc((X_pc_{1,1}),(X_pc_{2,1})) , get_auc((X_pc_{1,1}),(X_pc_{3,1})) , get_auc((X_pc_{2,1}),(X_pc_{3,1})) ;...
		get_auc((X_pc_{1,2}),(X_pc_{2,2})) , get_auc((X_pc_{1,2}),(X_pc_{3,2})) , get_auc((X_pc_{2,2}),(X_pc_{3,2})) ;...
		get_auc((X_pc_{1,3}),(X_pc_{2,3})) , get_auc((X_pc_{1,3}),(X_pc_{3,3})) , get_auc((X_pc_{2,3}),(X_pc_{3,3})) ;...
		 ];
    xx_ra = transpose([ARout(:);ACout(:);XRout(:);XCout(:)]);
    %}
  xmin = 0.0*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum,xc__dat,tot_n_dat] = helper_auc_AXXX_ver1('./dir_lakcluster_test_ADAADA/xx_out_ADAADA_old.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);

  % new ADAADA;
  % Two biclusters, both embedded in an A with sparsity sx_ra(1) = 0.0625;
  print('Warning! old version');
  nbins = 1; N_ra = 2.^[6:13]; X_factor_ra = [0.45:0.0125:0.65]; X_esm_ra = 10.^[-3:0.25:1]; gamma_ra = [0.01]; B_ra = [0];
  rng_num_ra = 1:64; X_factor_d_ra = floor(100*X_factor_ra); X_esm_d_ra = 10 + floor(-10*log10(X_esm_ra)); gamma_d_ra = floor(10*gamma_ra); ver_num=0;
  xcra = 8 + [1,2]; xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum_1,xc__dat_1,tot_n_dat_1] = helper_auc_AXXX_ver1('./dir_lakcluster_test_ADAADA/xx_out_ADAADA_g01.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);
  xcra = 8 + [3,4]; xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum_2,xc__dat_2,tot_n_dat_2] = helper_auc_AXXX_ver1('./dir_lakcluster_test_ADAADA/xx_out_ADAADA_g01.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);
  ng=1;nB=1;nxc=3; prows = 2; pcols = 4; lN = 8;
  figure;
  for nN=1:lN;
  subplot(prows,pcols,nN); 
  imagesc(squeeze(xc__sum_1(nN,:,:,ng,nB,nxc) - xc__sum_2(nN,:,:,ng,nB,nxc)),0.1*[-1,1]);
  colormap('jet'); axis off;
  end;%for nN=1:lN;

  % lakcluster_test_uADZSZDA_ver6;
  % nrows_X = ceil(N.^(X_factor)); nrows_XX = ceil(1.5*nrows_X);
  % ncols_X = ceil((N+1).^(X_factor)); ncols_XX = ceil(1.5*ncols_X);
  % X0 of size X, remaining clusters of size XX ;
  % X0 is balanced across covariate categories and T, and is exclusive to the cases ; 
  % X1 is balanced across T and is exclusive to the cases, but is restricted to covariate categories 2,3 ;
  % X2 is balanced across T and is exclusive to the cases, but is restricted to covariate categories 1,3 ;
  % X3 is balanced across T and is exclusive to the cases, but is restricted to covariate categories 1,2 ;
  % X4 is balanced across covariate categories and T, but spans both the cases and controls ;
  % X5 is balanced across covariate categories and is exclusive to the cases, but is restricted to positive T_u ;
  % X6 is balanced across covariate categories and is exclusive to the cases, but is restricted to negative T_u ;
  xx_out_fname = './dir_lakcluster_test_uADZSZDA/xx_out.bkp_081717e'; % Ireq=3;
  nbins = 3;
  N_ra = 2^10;
  X_factor_ra = [0.45:0.0125:0.65]; 
  X_esm_ra = 10.^[-3:0.25:1]; 
  gamma_ra = [0.01]; 
  B_ra = [32];
  rng_num_ra = 1:1; 
  xcra = 8 + [1]; xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum_1,xc__dat_1,tot_n_dat_1] = helper_auc_AXXX_ver1(xx_out_fname,xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);
  %figure(1); print('-depsc','dir_lakcluster_test_uADZSZDA/lakcluster_test_uADZSZDA_I3_x1_ver1.eps'); pause(1);
  %figure(1); print('-djpeg','dir_lakcluster_test_uADZSZDA/lakcluster_test_uADZSZDA_I3_x1_ver1.jpg'); pause(1);
  xcra = 8 + 1 + [3:3:9]; xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum_1,xc__dat_1,tot_n_dat_1] = helper_auc_AXXX_ver1(xx_out_fname,xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);
  %figure(4); print('-depsc','dir_lakcluster_test_uADZSZDA/lakcluster_test_uADZSZDA_I3_x470_ver1.eps'); pause(1);
  %figure(4); print('-djpeg','dir_lakcluster_test_uADZSZDA/lakcluster_test_uADZSZDA_I3_x470_ver1.jpg'); pause(1);
  xcra = 8 + 1 + [12:3:18]; xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum_1,xc__dat_1,tot_n_dat_1] = helper_auc_AXXX_ver1(xx_out_fname,xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);
  %figure(4); print('-depsc','dir_lakcluster_test_uADZSZDA/lakcluster_test_uADZSZDA_I3_x121518_ver1.eps'); pause(1);
  %figure(4); print('-djpeg','dir_lakcluster_test_uADZSZDA/lakcluster_test_uADZSZDA_I3_x121518_ver1.jpg'); pause(1);

  % uADZSZDA;
  % nrows_X = ceil(N.^(X_factor)); nrows_XX = ceil(1.5*nrows_X);
  % ncols_X = ceil((N+1).^(X_factor)); ncols_XX = ceil(1.5*ncols_X);
  % X0 of size X, remaining clusters of size XX ;
  % X0 is balanced across covariate categories and T, and is exclusive to the cases ; 
  % X1 is balanced across T and is exclusive to the cases, but is restricted to covariate categories 2,3 ;
  % X2 is balanced across T and is exclusive to the cases, but is restricted to covariate categories 1,3 ;
  % X3 is balanced across T and is exclusive to the cases, but is restricted to covariate categories 1,2 ;
  % X4 is balanced across covariate categories and T, but spans both the cases and controls ;
  % X5 is balanced across covariate categories and is exclusive to the cases, but is restricted to positive T_u ;
  % X6 is balanced across covariate categories and is exclusive to the cases, but is restricted to negative T_u ;
  print('Warning! old version');
  nbins = 3;
  N_ra = 2.^[9:12];
  X_factor_ra = [0.55:0.025:0.75];
  X_esm_ra = 10.^[-5:0.5:-1];
  gamma_ra = [0.05,0.50];%gamma_ra = [0.00,0.05,0.15,0.50];
  B_ra = [1,4,8,16];
  rng_num_ra = 1:16;
  X_factor_d_ra = floor(100*X_factor_ra);
  X_esm_d_ra = 10 + floor(-10*log10(X_esm_ra));
  gamma_d_ra = floor(10*gamma_ra);
  ver_num=2;
  xcra = 8 + [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18];
  % xx_ra = [ ...
  %           auc_r_0_x , auc_r_1_x , auc_r_2_x , auc_r_3_x , auc_r_4_x , auc_r_5_x , auc_r_6_x ; ...
  %           auc_c_0   , auc_c_1   , auc_c_2   , auc_c_3   , auc_c_4   , auc_c_5   , auc_c_6   ; ...
  % 	  ];
  % xx_ra = xx_ra(:);
  xmin = 0.0*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum,xc__dat,tot_n_dat] = helper_auc_AXXX_ver1('./dir_lakcluster_test_uADZSZDA/xx_out.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);

  % new uADZSZDA ;
  %!scp -p dir_lakcluster_test_uADZSZDA/xx_out_uADZSZDA_g01_ver1.txt rangan@access1.cims.nyu.edu:/data/rangan/dir_bcc/dir_code_022316/dir_lakcluster_test_uADZSZDA/xx_out_uADZSZDA_g01_ver1.txt ;  
  print('Warning! old version');
  nbins = 3; N_ra = 2.^[6:1:13]; X_factor_ra = [0.45:0.0125:0.65]; X_esm_ra = 10.^[-3:0.25:1]; gamma_ra = [0.01]; B_ra = [32];
  rng_num_ra = 1:64; X_factor_d_ra = floor(100*X_factor_ra); X_esm_d_ra = 10 + floor(-10*log10(X_esm_ra)); gamma_d_ra = floor(10*gamma_ra); ver_num=5;
  xcra = 8 + 1 + 3*[0:6]; xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum_1,xc__dat_1,tot_n_dat_1] = helper_auc_AXXX_ver1('./dir_lakcluster_test_uADZSZDA/xx_out_uADZSZDA_g01_ver1.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);
  %!scp -p dir_lakcluster_test_uADZSZDA/xx_out_uADZSZDA_g05_B08_XX15_ver0.txt rangan@access1.cims.nyu.edu:/data/rangan/dir_bcc/dir_code_022316/dir_lakcluster_test_uADZSZDA/xx_out_uADZSZDA_g05_B08_XX15_ver0.txt ;  
  nbins = 3; N_ra = 2.^[6:2:13]; X_factor_ra = [0.45:0.0125:0.65]; X_esm_ra = 10.^[-3:0.25:1]; gamma_ra = [0.05]; B_ra = [8];
  rng_num_ra = 1:64; X_factor_d_ra = floor(100*X_factor_ra); X_esm_d_ra = 10 + floor(-10*log10(X_esm_ra)); gamma_d_ra = floor(10*gamma_ra); ver_num=5;
  xcra = 8 + 1 + 3*[0:6]; xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum_1,xc__dat_1,tot_n_dat_1] = helper_auc_AXXX_ver1('./dir_lakcluster_test_uADZSZDA/xx_out_uADZSZDA_g05_B08_XX15_ver0.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);

  %!scp -p dir_lakcluster_test_uADZSZDA/xx_out_uADZSZDA_g01_B16_XX15_ver3.txt rangan@access1.cims.nyu.edu:/data/rangan/dir_bcc/dir_code_022316/dir_lakcluster_test_uADZSZDA/xx_out_uADZSZDA_g01_B16_XX15_ver3.txt ;  
  print('Warning! old version');
  nbins = 3; N_ra = 2.^[6:2:13]; X_factor_ra = [0.45:0.0125:0.65]; X_esm_ra = 10.^[-3:0.25:1]; gamma_ra = [0.01]; B_ra = [16];
  rng_num_ra = 1:64; X_factor_d_ra = floor(100*X_factor_ra); X_esm_d_ra = 10 + floor(-10*log10(X_esm_ra)); gamma_d_ra = floor(10*gamma_ra); ver_num=5;
  xcra = 8 + [1]; xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum_1,xc__dat_1,tot_n_dat_1] = helper_auc_AXXX_ver1('./dir_lakcluster_test_uADZSZDA/xx_out_uADZSZDA_g01_B16_XX15_ver3.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);
  figure(1); print('-depsc','dir_lakcluster_test_uADZSZDA/lakcluster_test_uADZSZDA_x1_ver0.eps');
  figure(1); print('-djpeg','dir_lakcluster_test_uADZSZDA/lakcluster_test_uADZSZDA_x1_ver0.jpg');
  xcra = 8 + 1 + [3:3:9]; xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum_1,xc__dat_1,tot_n_dat_1] = helper_auc_AXXX_ver1('./dir_lakcluster_test_uADZSZDA/xx_out_uADZSZDA_g01_B16_XX15_ver3.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);
  figure(4); print('-depsc','dir_lakcluster_test_uADZSZDA/lakcluster_test_uADZSZDA_x470_ver0.eps');
  figure(4); print('-djpeg','dir_lakcluster_test_uADZSZDA/lakcluster_test_uADZSZDA_x470_ver0.jpg');
  xcra = 8 + 1 + [12:3:18]; xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum_1,xc__dat_1,tot_n_dat_1] = helper_auc_AXXX_ver1('./dir_lakcluster_test_uADZSZDA/xx_out_uADZSZDA_g01_B16_XX15_ver3.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);
  figure(4); print('-depsc','dir_lakcluster_test_uADZSZDA/lakcluster_test_uADZSZDA_x121518_ver0.eps');
  figure(4); print('-djpeg','dir_lakcluster_test_uADZSZDA/lakcluster_test_uADZSZDA_x121518_ver0.jpg');
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% ;
  %!scp -p dir_lakcluster_test_uADZSZDA/xx_out_uADZSZDA_g01_B16_n01_XX15_ver5.txt rangan@access1.cims.nyu.edu:/data/rangan/dir_bcc/dir_code_022316/dir_lakcluster_test_uADZSZDA/xx_out_uADZSZDA_g01_B16_n01_XX15_ver5.txt ;    
  nbins = 3; N_ra = 2.^[6:2:13]; X_factor_ra = [0.45:0.0125:0.65]; X_esm_ra = 10.^[-3:0.25:1]; gamma_ra = [0.01]; B_ra = [16];
  rng_num_ra = 1:64; X_factor_d_ra = floor(100*X_factor_ra); X_esm_d_ra = 10 + floor(-10*log10(X_esm_ra)); gamma_d_ra = floor(10*gamma_ra); ver_num=5;
  xcra = 8 + [1]; xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum_1,xc__dat_1,tot_n_dat_1] = helper_auc_AXXX_ver1('./dir_lakcluster_test_uADZSZDA/xx_out_uADZSZDA_g01_B16_n01_XX15_ver5.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);
  figure(1); print('-depsc','dir_lakcluster_test_uADZSZDA/lakcluster_test_uADZSZDA_n01_x1_ver0.eps'); pause(1);
  figure(1); print('-djpeg','dir_lakcluster_test_uADZSZDA/lakcluster_test_uADZSZDA_n01_x1_ver0.jpg'); pause(1);
  xcra = 8 + 1 + [3:3:9]; xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum_1,xc__dat_1,tot_n_dat_1] = helper_auc_AXXX_ver1('./dir_lakcluster_test_uADZSZDA/xx_out_uADZSZDA_g01_B16_n01_XX15_ver5.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);
  figure(4); print('-depsc','dir_lakcluster_test_uADZSZDA/lakcluster_test_uADZSZDA_n01_x470_ver0.eps'); pause(1);
  figure(4); print('-djpeg','dir_lakcluster_test_uADZSZDA/lakcluster_test_uADZSZDA_n01_x470_ver0.jpg'); pause(1);
  xcra = 8 + 1 + [12:3:18]; xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum_1,xc__dat_1,tot_n_dat_1] = helper_auc_AXXX_ver1('./dir_lakcluster_test_uADZSZDA/xx_out_uADZSZDA_g01_B16_n01_XX15_ver5.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);
  figure(4); print('-depsc','dir_lakcluster_test_uADZSZDA/lakcluster_test_uADZSZDA_n01_x121518_ver0.eps'); pause(1);
  figure(4); print('-djpeg','dir_lakcluster_test_uADZSZDA/lakcluster_test_uADZSZDA_n01_x121518_ver0.jpg'); pause(1);
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  %!scp -p dir_lakcluster_test_uADZSZDA/xx_out_uADZSZDA_g01_B16_n01_XX15_ver5b.txt rangan@access1.cims.nyu.edu:/data/rangan/dir_bcc/dir_code_022316/dir_lakcluster_test_uADZSZDA/xx_out_uADZSZDA_g01_B16_n01_XX15_ver5b.txt ;    
  nbins = 3; N_ra = 2.^[6:2:13]; X_factor_ra = [0.45:0.0125:0.65]; X_esm_ra = 10.^[-3:0.25:1]; gamma_ra = [0.01]; B_ra = [16];
rng_num_ra = 1:64; X_factor_d_ra = floor(100*X_factor_ra); X_esm_d_ra = 10 + floor(-10*log10(X_esm_ra)); gamma_d_ra = floor(10*gamma_ra); ver_num=5;
  xcra = 8 + [1]; xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum_1,xc__dat_1,tot_n_dat_1] = helper_auc_AXXX_ver1('./dir_lakcluster_test_uADZSZDA/xx_out_uADZSZDA_g01_B16_n01_XX15_ver5b.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);
  figure(1); print('-depsc','dir_lakcluster_test_uADZSZDA/lakcluster_test_uADZSZDA_n01_x1_ver1.eps'); pause(1);
  figure(1); print('-djpeg','dir_lakcluster_test_uADZSZDA/lakcluster_test_uADZSZDA_n01_x1_ver1.jpg'); pause(1);
  xcra = 8 + 1 + [3:3:9]; xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum_1,xc__dat_1,tot_n_dat_1] = helper_auc_AXXX_ver1('./dir_lakcluster_test_uADZSZDA/xx_out_uADZSZDA_g01_B16_n01_XX15_ver5b.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);
  figure(4); print('-depsc','dir_lakcluster_test_uADZSZDA/lakcluster_test_uADZSZDA_n01_x470_ver1.eps'); pause(1);
  figure(4); print('-djpeg','dir_lakcluster_test_uADZSZDA/lakcluster_test_uADZSZDA_n01_x470_ver1.jpg'); pause(1);
  xcra = 8 + 1 + [12:3:18]; xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum_1,xc__dat_1,tot_n_dat_1] = helper_auc_AXXX_ver1('./dir_lakcluster_test_uADZSZDA/xx_out_uADZSZDA_g01_B16_n01_XX15_ver5b.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);
  figure(4); print('-depsc','dir_lakcluster_test_uADZSZDA/lakcluster_test_uADZSZDA_n01_x121518_ver1.eps'); pause(1);
  figure(4); print('-djpeg','dir_lakcluster_test_uADZSZDA/lakcluster_test_uADZSZDA_n01_x121518_ver1.jpg'); pause(1);
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% ;
  %!scp -p dir_lakcluster_test_uADZSZDA/xx_out_uADZSZDA_tmp0.txt rangan@access1.cims.nyu.edu:/data/rangan/dir_bcc/dir_code_022316/dir_lakcluster_test_uADZSZDA/xx_out_uADZSZDA_tmp0.txt ; (nb_srt=1);
  nbins = 3; N_ra = 2.^[6:2:13]; X_factor_ra = [0.45:0.0125:0.65]; X_esm_ra = 10.^[-3:0.25:1]; gamma_ra = [0.01]; B_ra = [16];
rng_num_ra = 1:64; X_factor_d_ra = floor(100*X_factor_ra); X_esm_d_ra = 10 + floor(-10*log10(X_esm_ra)); gamma_d_ra = floor(10*gamma_ra); ver_num=5;
  xcra = 8 + [1]; xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum_1,xc__dat_1,tot_n_dat_1] = helper_auc_AXXX_ver1('./dir_lakcluster_test_uADZSZDA/xx_out_uADZSZDA_tmp0.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);
  xcra = 8 + 1 + [3:3:9]; xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum_1,xc__dat_1,tot_n_dat_1] = helper_auc_AXXX_ver1('./dir_lakcluster_test_uADZSZDA/xx_out_uADZSZDA_tmp0.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);
  xcra = 8 + 1 + [12:3:18]; xmin = 0.5*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum_1,xc__dat_1,tot_n_dat_1] = helper_auc_AXXX_ver1('./dir_lakcluster_test_uADZSZDA/xx_out_uADZSZDA_tmp0.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);


  % get timing data;
  print('Warning! old version');
  tcra = [7,8]; tmin = 0.0*ones(1,2); tmax = 1024*ones(1,2);
  [tc__sum,tc__dat,tot_n_dat] = helper_auc_AXXX_ver1('./dir_lakcluster_test_uADZSZDA/xx_out.txt',tcra,tmin,tmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);
  lN = length(N_ra); lf = length(X_factor_d_ra); le = length(X_esm_d_ra); lg = length(gamma_d_ra); lB = length(B_ra); lr = length(rng_num_ra);
  tc_avg = zeros(lN,lg,lB,length(tcra));
  for nx=1:length(tcra); for nN=1:lN; for ng=1:lg; for nB=1:lB; tmp = tc__sum(nN,:,:,ng,nB,nx); tmp = tmp(:); tc_avg(nN,ng,nB,nx) = mean(tmp); end;end;end;end;
  ltlim = floor([log2(0.01),log2(3600*24)]);
  subplot(1,1,1); cla; hold on;
  lra_g = {'o','x'};
  lra_B = {'g','b','m','r'};
  lra_x = {'elrt','elct'};
  plot(log2(N_ra),log2(N_ra.^3),'k-');
  for nx=1:length(tcra); subplot(1,2,nx); hold on; 
  for ng=1:lg; for nB=1:lB; tmp = tc__sum(nN,:,:,ng,nB,nx); plot(log2(N_ra),log2(tc_avg(:,ng,nB,nx)),sprintf('%s%s-',lra_g{ng},lra_B{nB})); end;end;
  xlim([log2(N_ra(1)),log2(N_ra(end))]);
  ylim(ltlim);
  xlabel('N');set(gca,'XTick',log2(N_ra),'XTickLabel',N_ra); ylabel('log2(time (s))');set(gca,'YTick',ltlim(1):ltlim(2),'YTickLabel',ltlim(1):ltlim(2)); title(sprintf('%s',lra_x{nx}));
  hold off;
  end;%for nx;

  % uAZSZA;
  % nbins = 3; N_ra = 2.^[9:12]; X_factor_ra = [0.55:0.025:0.75]; X_esm_ra = 10.^[-5:0.5:-1]; gamma_ra = [0.05,0.50];%gamma_ra = [0.00,0.05,0.15,0.50]; 
  % B_ra = [1,4,8,16]; rng_num_ra = 1:16; X_factor_d_ra = floor(100*X_factor_ra); X_esm_d_ra = 10 + floor(-10*log10(X_esm_ra)); gamma_d_ra = floor(10*gamma_ra); ver_num=1;
  % nrows_A_ = ceil(N/nbins*ones(1,nbins)) ;
  % nrows_Z_ = ceil(2*N/nbins*ones(1,nbins)) ;
  % ncols_A = N ;
  % ncols_Y = 0;
  % nmds = 3; mds_scale_factor = [1.00,0.30,0.12,0.10,0.09];
  % nrows_X = ceil(N.^(X_factor)); nrows_XX = ceil(1.5*nrows_X);
  % ncols_X = ceil((N+1).^(X_factor)); ncols_XX = ceil(1.5*ncols_X);
  % X0 of size X, remaining clusters of size XX ;
  % X0 is balanced across covariate categories and T, and is exclusive to the cases ; 
  % X1 is balanced across T and is exclusive to the cases, but is restricted to covariate categories 2,3 ;
  % X2 is balanced across T and is exclusive to the cases, but is restricted to covariate categories 1,3 ;
  % X3 is balanced across T and is exclusive to the cases, but is restricted to covariate categories 1,2 ;
  % X4 is balanced across covariate categories and T, but spans both the cases and controls ;
  % X5 is balanced across covariate categories and is exclusive to the cases, but is restricted to positive T_u ;
  % X6 is balanced across covariate categories and is exclusive to the cases, but is restricted to negative T_u ;
  print('Warning! old version');
  nbins = 3; N_ra = 2.^[9:12]; X_factor_ra = [0.55:0.025:0.75]; X_esm_ra = 10.^[-3:0.5:+1]; gamma_ra = [0.05,0.50];%gamma_ra = [0.00,0.05,0.15,0.50]; 
  B_ra = [1,4,8,16]; rng_num_ra = 1:16; X_factor_d_ra = floor(100*X_factor_ra); X_esm_d_ra = 10 + floor(-10*log10(X_esm_ra)); gamma_d_ra = floor(10*gamma_ra); ver_num=1;
  xcra = 8 + [1,2,3,4,5,6,7,8,9,10,11,12,13,14];
  %xx_ra = [ ...
  %        auc_r_0_x , auc_r_1_x , auc_r_2_x , auc_r_3_x , auc_r_4_x , auc_r_5_x , auc_r_6_x ; ...
  %        auc_c_0   , auc_c_1   , auc_c_2   , auc_c_3   , auc_c_4   , auc_c_5   , auc_c_6   ; ...
  %	  ];
  xmin = 0.0*ones(1,length(xcra)); xmax = 1.0*ones(1,length(xcra));
  [xc__sum,xc__dat,tot_n_dat] = helper_auc_AXXX_ver1('./dir_lakcluster_test_uAZSZA/xx_out.txt',xcra,xmin,xmax,N_ra,X_factor_ra,X_esm_ra,gamma_ra,B_ra,rng_num_ra);


  %}

X_factor_d_ra = floor(100*X_factor_ra);
X_esm_d_ra = 10 + floor(-10*log10(X_esm_ra));
gamma_d_ra = floor(100*gamma_ra);

lN = length(N_ra);
lf = length(X_factor_d_ra);
le = length(X_esm_d_ra);
lg = length(gamma_d_ra);
lB = length(B_ra);
lr = length(rng_num_ra);
lT = lN*lf*le*lg*lB*lr;
disp(sprintf('lN %d lf %d le %d lg %d lB %d lr %d lT %d',lN,lf,le,lg,lB,lr,lT));
x = csvread(aucname);
lxc = length(xcra);
xc__dat = zeros(lN,lf,le,lg,lB,lr,lxc);
tot_n_dat = zeros(lN,lf,le,lg,lB,lr);
elrt_dat = zeros(lN,lf,le,lg,lB,lr);
elct_dat = zeros(lN,lf,le,lg,lB,lr);
for nx=1:size(x,1);
N = x(nx,1);
X_factor_d = x(nx,2);
X_esm_d = x(nx,3);
gamma_d = x(nx,4);
B_MLT = x(nx,5);
rng_num = x(nx,6);
bN = find(abs(N_ra-N)<=1);
bf = find(abs(X_factor_d_ra-X_factor_d)<=1);
be = find(abs(X_esm_d_ra-X_esm_d)<=1);
bg = find(abs(gamma_d_ra-gamma_d)<=1);
bB = find(abs(B_ra-B_MLT)<=1);
br = find(rng_num_ra==rng_num);
elrt_dat(bN,bf,be,bg,bB,br) = x(nx,7);
elct_dat(bN,bf,be,bg,bB,br) = x(nx,8);
for nxc=1:lxc; xc__dat(bN,bf,be,bg,bB,br,nxc) = x(nx,xcra(nxc)); end;%for nxc=1:lxc;
tot_n_dat(bN,bf,be,bg,bB,br) = 1;
end;%for nx=1:size(x,1);
disp(sprintf(' %% %d/%d = %.2f found',sum(tot_n_dat(:)),lT,100*sum(tot_n_dat(:))/lT));
tot_n_dat_sum = squeeze(max(1,sum(tot_n_dat,6)));

plot_flag=1;
if plot_flag;

if lB==1 & lg>=1 & lN>1;
elrt_sum(:,:,:,:,:) = squeeze(sum(elrt_dat(:,:,:,:,:,:),6))./tot_n_dat_sum;
elct_sum(:,:,:,:,:) = squeeze(sum(elct_dat(:,:,:,:,:,:),6))./tot_n_dat_sum;
for nxc = 1:lxc;
xc__sum(:,:,:,:,:,nxc) = squeeze(sum(xc__dat(:,:,:,:,:,:,nxc),6))./tot_n_dat_sum;
end;%for nxc = 1:lxc;
% fill in ? ; 
%xc__sum = infill(xc__sum,tot_n_dat_sum);
%xc__sum(:,:,:,:,:,lxc+1) = max(xc__sum(:,:,:,:,:,1:lxc),[],6);
xc__sum(:,:,:,:,:,lxc+1) = mean(xc__sum(:,:,:,:,:,1:lxc),6);
xmin(lxc+1) = mean(xmin(1:lxc)); xmax(lxc+1) = mean(xmax(1:lxc)); xcra(lxc+1) = mean(xcra(1:lxc));
nB=1;
if lN==8; prows = 2; pcols = 4; elseif lN==4; prows = 1; pcols = 4; else; prows = lg*2; pcols = ceil(lN/2); end;%lN;
for nxc = 1:lxc+1;
figure;
for ng=1:lg;
for nN=1:lN;
subplot(prows,pcols,nN + (ng-1)*lN); 
%if (xmax(nxc)>xmin(nxc)); disp('sorting c_r'); imagesc(sort2(squeeze(xc__sum(nN,:,:,ng,nB,nxc)),'c_r'),[xmin(nxc),xmax(nxc)]); else; disp('sorting r_c'); imagesc(sort2(squeeze(xc__sum(nN,:,:,ng,nB,nxc)),'r_c'),[xmin(nxc),xmax(nxc)]); end;
imagesc(squeeze(xc__sum(nN,:,:,ng,nB,nxc)),[xmin(nxc),xmax(nxc)]);
colormap('hot'); %colorbar;
ylabel('log_M(M_X)');set(gca,'YTick',1:lf,'YTickLabel',X_factor_ra);
xlabel('log10(eps*sqrt(M_X))');set(gca,'XTick',1:le,'XTickLabel',round(10*log10(X_esm_ra))/10);
%title(sprintf('nxc %d --> xc %d nN %d bg %d',nxc,xcra(nxc),N_ra(nN),gamma_d_ra(ng)));
axis off;
end;%for nN=1:lN;
end;%for ng=1:lg;
end;%for nxc = 1:lxc+1;
figure;cla;
subplot(1,3,1);plot(log2(N_ra),log2(reshape(elrt_sum,lN,lf*le*lg*lB)),'rx'); title('elrt');
subplot(1,3,2);plot(log2(N_ra),log2(reshape(elct_sum,lN,lf*le*lg*lB)),'bo'); title('elct');
subplot(1,3,3);plot(log2(N_ra),reshape(elct_sum,lN,lf*le*lg*lB)./reshape(elrt_sum,lN,lf*le*lg*lB),'ks'); title('elct/elrt');
end;%if lB==1 & lg>1 & lN>1;

if lB==1 & lg>=1 & lN==1;
for nxc = 1:lxc;
xc__sum(:,:,:,:,nxc) = squeeze(sum(xc__dat(:,:,:,:,:,:,nxc),6))./tot_n_dat_sum;
end;%for nxc = 1:lxc;
nB=1;
prows = 1+(lg>1); pcols = ceil(lg/2);
xc__tmp = mean(xc__sum(:,:,:,:,1:lxc),5);
xc__sum(:,:,1,1,lxc+1) = xc__tmp(:,:,1,1);
xmin(lxc+1) = mean(xmin(1:lxc)); xmax(lxc+1) = mean(xmax(1:lxc)); xcra(lxc+1) = mean(xcra(1:lxc));
for nxc = 1:lxc+1;
figure;
%sort_str_1 = 'c_r'; sort_str_2 = 'r_c';
sort_str_1 = 'none'; sort_str_2 = 'none';
nN=1; ng=lg;
if (xmax(nxc)>xmin(nxc)); tmp_g = sort2(squeeze(xc__sum(:,:,ng,nB,nxc)),sort_str_1); else; tmp_g = sort2(squeeze(xc__sum(:,:,ng,nB,nxc)),'sort_str_2'); end;
nN=1; for ng=1:lg;
subplot(prows,pcols,nN + (ng-1)*lN); 
colormap('hot');
if (xmax(nxc)>xmin(nxc)); imagesc(sort2(squeeze(xc__sum(:,:,ng,nB,nxc)),sort_str_1),[xmin(nxc),xmax(nxc)]); else; imagesc(sort2(squeeze(xc__sum(:,:,ng,nB,nxc)),'sort_str_2'),[xmin(nxc),xmax(nxc)]); end;
ylabel('log_M(M_X)');set(gca,'YTick',1:lf,'YTickLabel',X_factor_ra);
xlabel('log10(eps*sqrt(M_X))');set(gca,'XTick',1:le,'XTickLabel',round(10*log10(X_esm_ra))/10);
%title(sprintf('nxc %d --> xc %d nN %d bg %d',nxc,xcra(nxc),N_ra(nN),gamma_d_ra(ng)));
axis off;
end;%for ng=1:lg;
end;%for nxc = 1:lxc;

% Take difference between results for final gamma and results for earlier gamma ;
%{
for nxc = 1:lxc;
figure;
nN=1; ng=lg;
if (xmax(nxc)>xmin(nxc)); tmp_g = sort2(squeeze(xc__sum(:,:,ng,nB,nxc)),'c_r'); else; tmp_g = sort2(squeeze(xc__sum(:,:,ng,nB,nxc)),'r_c'); end;
nN=1; for ng=1:lg;
subplot(prows,pcols,nN + (ng-1)*lN); 
colormap('jet');
if (xmax(nxc)>xmin(nxc)); imagesc(tmp_g - sort2(squeeze(xc__sum(:,:,ng,nB,nxc)),'c_r'),0.25*[0,+1]); else; imagesc(tmp_g - sort2(squeeze(xc__sum(:,:,ng,nB,nxc)),'r_c'),0.25*[0,+1]); end;
ylabel('log_M(M_X)');set(gca,'YTick',1:lf,'YTickLabel',X_factor_ra);
xlabel('log10(eps*sqrt(M_X))');set(gca,'XTick',1:le,'XTickLabel',round(10*log10(X_esm_ra))/10);
%title(sprintf('nxc %d --> xc %d nN %d bg %d',nxc,xcra(nxc),N_ra(nN),gamma_d_ra(ng)));
axis off;
end;%for ng=1:lg;
end;%for nxc = 1:lxc;
 %}

end;%if lB==1 & lg>1 & lN==1;

%{
% plot array of lB-by-lN ;
if (lB>1 & lg==2 & lN>1);
prows = lB; pcols = 2*lN;
for nxc = 1:lxc;
figure;
ng=1;
for nB=1:lB;
for nN=1:lN;
subplot(prows,pcols,0*lN + nN + (nB-1)*2*lN); 
if (xmax(nxc)>xmin(nxc)); imagesc(squeeze(xc__sum(nN,:,:,ng,nB,nxc)),[xmin(nxc),xmax(nxc)]); else; imagesc(squeeze(xc__sum(nN,:,:,ng,nB,nxc))); end;
ylabel('log_M(M_X)');set(gca,'YTick',1:lf,'YTickLabel',X_factor_ra);
xlabel('log10(eps*sqrt(M_X))');set(gca,'XTick',1:le,'XTickLabel',round(10*log10(X_esm_ra))/10);
title(sprintf('nxc %d --> xc %d nN %d bg %d nB %d',nxc,xcra(nxc),N_ra(nN),gamma_d_ra(ng),B_ra(nB)));
end;%for nN=1:lN;
end;%for nB=1:lB;
ng=2;
for nB=1:lB;
for nN=1:lN;
subplot(prows,pcols,1*lN + nN + (nB-1)*2*lN); 
if (xmax(nxc)>xmin(nxc)); imagesc(squeeze(xc__sum(nN,:,:,ng,nB,nxc)),[xmin(nxc),xmax(nxc)]); else; imagesc(squeeze(xc__sum(nN,:,:,ng,nB,nxc))); end;
ylabel('log_M(M_X)');set(gca,'YTick',1:lf,'YTickLabel',X_factor_ra);
xlabel('log10(eps*sqrt(M_X))');set(gca,'XTick',1:le,'XTickLabel',round(10*log10(X_esm_ra))/10);
title(sprintf('nxc %d --> xc %d nN %d bg %d nB %d',nxc,xcra(nxc),N_ra(nN),gamma_d_ra(ng),B_ra(nB)));
end;%for nN=1:lN;
end;%for nB=1:lB;
end;%for nxc = 1:lxc;
end;%if (lB>1 & lg>1 & lN>1);
 %}

% plot array for nB=lB, nN=lN, ng=1;
if (lB>1 & (lg==2 | lg==1) & lN>1);
nB=lB;ng=1;nN=lN;
prows = 3; pcols = 6;
figure;
for nxc = 1:lxc;
subplot(prows,pcols,nxc);
if (xmax(nxc)>xmin(nxc)); imagesc(squeeze(xc__sum(nN,:,:,ng,nB,nxc)),[xmin(nxc),xmax(nxc)]); else; imagesc(squeeze(xc__sum(nN,:,:,ng,nB,nxc))); end;
ylabel('log_M(M_X)');set(gca,'YTick',1:lf,'YTickLabel',X_factor_ra);
xlabel('log10(eps*sqrt(M_X))');set(gca,'XTick',1:le,'XTickLabel',round(10*log10(X_esm_ra))/10);
title(sprintf('nxc %d --> xc %d nN %d bg %d nB %d',nxc,xcra(nxc),N_ra(nN),gamma_d_ra(ng),B_ra(nB)));
end;%for nxc = 1:lxc;
end;%if (lB>1 & lg>1 & lN>1);

end;%if plot_flag;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

function output = sort2(input,rvsc);
% double sort ;
output = input;
if strcmp(rvsc,'row'); for nc=1:size(input,2); output(:,nc) = sort(output(:,nc),'ascend'); end; end;
if strcmp(rvsc,'col'); for nr=1:size(input,1); output(nr,:) = sort(output(nr,:),'descend'); end; end;
if strcmp(rvsc,'r_c'); output = sort2(output,'row'); output = sort2(output,'col'); end;
if strcmp(rvsc,'c_r'); output = sort2(output,'col'); output = sort2(output,'row'); end;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

function input = infill(input,tot_n_sum_dat);
[nN,nX,ne,nB,ng] = size(input);
for mN=1:nN; for mB=1:nB; for mg=1:ng;
for mX=1:nX; for me=1:ne;
if tot_n_sum_dat(mN,mX,me,mB,mg)<=1;
disp(sprintf('%% Warning! Filling in: [mN %d ,mX %d ,me %d ,mB %d ,mg %d]',mN,mX,me,mB,mg));
if (mX>1 & mX<nX); input(mN,mX,me,mB,mg) = 0.5*input(mN,mX+1,me,mB,mg)+0.5*input(mN,mX-1,me,mB,mg); 
elseif (me>1 & me<ne); input(mN,mX,me,mB,mg) = 0.5*input(mN,mX,me+1,mB,mg)+0.5*input(mN,mX,me-1,mB,mg); 
end;%if;
end;%if tot_n_sum_dat(mN,mX,me,mB,mg)<=1;
end;end;%for mX=1:nX; for me=1:ne;
end;end;end;%for mN=1:nN; for mB=1:nB; for mg=1:ng;
