flag_isosplit5 = 0; flag_trace = 0; flag_scorebox = 1;

%%%%%%%%;
setup;
%flag_isosplit5 = 1; flag_trace = 1; flag_scorebox = 0;
str_ntype = 'limp';
str_ctype_ = {'000','012','042','127'};
n_col_ = [1:6];
dir_trunk = sprintf('/data/rangan/dir_bcc/dir_jamison');
[n_u,CLabel_sub_] = test_loader_helper_CLabel_sub_(dir_trunk);
%%%%%%%%;
E_xxxx_ = textread(sprintf('%s/dir_mat/E_%s_.tsv',dir_trunk,str_ntype)); E_xxxx_ = E_xxxx_(:,1:end-1);
for str_ctype = str_ctype_;
if ( strcmp(str_ctype{1},'000'));
prefix = sprintf('E_%s_c%s',str_ntype,str_ctype{1}); 
prefix_base = prefix; gamma = 0.01; n_shuffle = 64; dir_out = []; E_array_base_ = E_xxxx_; E_array_r_ij_ = []; E_array_c_ij_ = []; p_set = exp(-2);
if flag_isosplit5; test_loader_dexcluster_nonbinary_isosplit5_recursive_0([],prefix_base,E_xxxx_,[],[],gamma,n_shuffle,p_set); end;
if flag_trace; test_loader_dexcluster_nonbinary_trace_recursive_0([],prefix_base,E_xxxx_,[],[],gamma,n_shuffle,p_set); end;
if flag_scorebox; test_loader_dexcluster_nonbinary_scorebox_recursive_0([],prefix_base,E_xxxx_,[],[],gamma,n_shuffle,p_set); end;
end;%if ( strcmp(str_ctype{1},'000'));
if (~strcmp(str_ctype{1},'000'));
C_rank_cxxx_ = textread(sprintf('%s/dir_mat/C_rank_c%s_.tsv',dir_trunk,str_ctype{1})); C_rank_cxxx_ = C_rank_cxxx_(:,1:end-1);
[E_xxxx_cxxx_beta_un_,E_xxxx_cxxx_beta_vn_,n_E_xxxx_cxxx_beta,E_xxxx_cxxx_zeta_un_,E_xxxx_cxxx_zeta_vn_,n_E_xxxx_cxxx_zeta] = test_loader_lm_RRR_E_0(C_rank_cxxx_,E_xxxx_,dir_trunk,sprintf('%s_c%s',str_ntype,str_ctype{1}));
for ncol_=1:length(n_col_);
n_col = n_col_(ncol_);
E_xxxx_cxxx_ = E_xxxx_ - [ (ones(n_u,1)*E_xxxx_cxxx_zeta_un_(1,1:n_col) + C_rank_cxxx_*E_xxxx_cxxx_zeta_un_(2:end,1:n_col))*transpose(E_xxxx_cxxx_zeta_vn_(:,1:n_col)) ]; %<-- correct for linear effect of covariates. ;
prefix = sprintf('E_%s_c%sr%d',str_ntype,str_ctype{1},n_col); 
prefix_base = prefix; gamma = 0.01; n_shuffle = 64; dir_out = []; E_array_base_ = E_xxxx_cxxx_; E_array_r_ij_ = []; E_array_c_ij_ = []; p_set = exp(-2);
if flag_isosplit5; test_loader_dexcluster_nonbinary_isosplit5_recursive_0([],prefix_base,E_xxxx_cxxx_,[],[],gamma,n_shuffle,p_set); end;
if flag_trace; test_loader_dexcluster_nonbinary_trace_recursive_0([],prefix_base,E_xxxx_cxxx_,[],[],gamma,n_shuffle,p_set); end;
if flag_scorebox; test_loader_dexcluster_nonbinary_scorebox_recursive_0([],prefix_base,E_xxxx_cxxx_,[],[],gamma,n_shuffle,p_set); end;
%clear E_xxxx_cxxx_ ;
end;%for ncol_=1:length(n_col_);
end;%if (~strcmp(str_ctype{1},'000'));
end;%  for str_ctype = str_ctype_;
%clear E_xxxx_ ;
%%%%%%%%;

%%%%%%%%;
setup;
%flag_isosplit5 = 1; flag_trace = 1; flag_scorebox = 0;
str_ntype = 'limp';
str_ctype_ = {'000','012','042','127'};
n_col_ = [1:6];
dir_trunk = sprintf('/data/rangan/dir_bcc/dir_jamison');
[n_u,CLabel_sub_] = test_loader_helper_CLabel_sub_(dir_trunk);
%%%%%%%%;
I_xxxx_ = textread(sprintf('%s/dir_mat/I_%s_.tsv',dir_trunk,str_ntype)); I_xxxx_ = I_xxxx_(:,1:end-1);
for str_ctype = str_ctype_;
if ( strcmp(str_ctype{1},'000'));
prefix = sprintf('I_%s_c%s',str_ntype,str_ctype{1}); 
prefix_base = prefix; gamma = 0.01; n_shuffle = 64; dir_out = []; I_array_base_ = I_xxxx_; I_array_r_ij_ = []; I_array_c_ij_ = []; p_set = exp(-2);
if flag_isosplit5; test_loader_dexcluster_nonbinary_isosplit5_recursive_0([],prefix_base,I_xxxx_,[],[],gamma,n_shuffle,p_set); end;
if flag_trace; test_loader_dexcluster_nonbinary_trace_recursive_0([],prefix_base,I_xxxx_,[],[],gamma,n_shuffle,p_set); end;
if flag_scorebox; test_loader_dexcluster_nonbinary_scorebox_recursive_0([],prefix_base,I_xxxx_,[],[],gamma,n_shuffle,p_set); end;
end;%if ( strcmp(str_ctype{1},'000'));
if (~strcmp(str_ctype{1},'000'));
C_rank_cxxx_ = textread(sprintf('%s/dir_mat/C_rank_c%s_.tsv',dir_trunk,str_ctype{1})); C_rank_cxxx_ = C_rank_cxxx_(:,1:end-1);
[I_xxxx_cxxx_beta_un_,I_xxxx_cxxx_beta_vn_,n_I_xxxx_cxxx_beta,I_xxxx_cxxx_zeta_un_,I_xxxx_cxxx_zeta_vn_,n_I_xxxx_cxxx_zeta] = test_loader_lm_RRR_I_0(C_rank_cxxx_,I_xxxx_,dir_trunk,sprintf('%s_c%s',str_ntype,str_ctype{1}));
for ncol_=1:length(n_col_);
n_col = n_col_(ncol_);
I_xxxx_cxxx_ = I_xxxx_ - [ (ones(n_u,1)*I_xxxx_cxxx_zeta_un_(1,1:n_col) + C_rank_cxxx_*I_xxxx_cxxx_zeta_un_(2:end,1:n_col))*transpose(I_xxxx_cxxx_zeta_vn_(:,1:n_col)) ]; %<-- correct for linear effect of covariates. ;
prefix = sprintf('I_%s_c%sr%d',str_ntype,str_ctype{1},n_col); 
prefix_base = prefix; gamma = 0.01; n_shuffle = 64; dir_out = []; I_array_base_ = I_xxxx_cxxx_; I_array_r_ij_ = []; I_array_c_ij_ = []; p_set = exp(-2);
if flag_isosplit5; test_loader_dexcluster_nonbinary_isosplit5_recursive_0([],prefix_base,I_xxxx_cxxx_,[],[],gamma,n_shuffle,p_set); end;
if flag_trace; test_loader_dexcluster_nonbinary_trace_recursive_0([],prefix_base,I_xxxx_cxxx_,[],[],gamma,n_shuffle,p_set); end;
if flag_scorebox; test_loader_dexcluster_nonbinary_scorebox_recursive_0([],prefix_base,I_xxxx_cxxx_,[],[],gamma,n_shuffle,p_set); end;
%clear I_xxxx_cxxx_ ;
end;%for ncol_=1:length(n_col_);
end;%if (~strcmp(str_ctype{1},'000'));
end;%  for str_ctype = str_ctype_;
%clear I_xxxx_ ;
%%%%%%%%;
