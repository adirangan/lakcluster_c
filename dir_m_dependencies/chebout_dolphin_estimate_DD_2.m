function [DDinv_vvt__,detDDinv_t_] = chebout_dolphin_estimate_DD_2(dt_,BB__,CC__,eig_tolerance);
if (nargin<4); eig_tolerance = 1e-6; end;
verbose=0;
n_dt = numel(dt_);
n_var = size(BB__,1);
DDinv_vvt__ = zeros(n_var^2,n_dt);
detDDinv_t_ = zeros(n_dt,1);
[u_dt_,index_u_from_all_,index_all_from_u_] = unique(round(dt_/eig_tolerance)*eig_tolerance,'stable');
index_u_from_all_ = index_u_from_all_ - 1; index_all_from_u_ = index_all_from_u_ - 1;
n_u_dt = numel(u_dt_);
if (verbose); disp(sprintf(' %% n_u_dt %d',n_u_dt)); end;
DDinv_vvu__ = zeros(n_var^2,n_u_dt);
detDDinv_u_ = zeros(n_u_dt,1);
for nudt=0:n_u_dt-1;
dt = u_dt_(1+nudt);
[DDinv__,detDDinv] = dolphin_estimate_DD_1(dt,BB__,CC__,eig_tolerance);
DDinv_vvu__(:,1+nudt) = reshape(DDinv__,[1,n_var^2]);
detDDinv_u_(1+nudt) = detDDinv;
end;%for nudt=0:n_u_dt-1;
DDinv_vvt__ = DDinv_vvu__(:,1+index_all_from_u_);
detDDinv_t_ = detDDinv_u_(1+index_all_from_u_);
