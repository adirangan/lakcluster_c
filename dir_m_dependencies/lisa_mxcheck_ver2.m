%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% ;
% run lisa_setprefix_ver2 first. ;
% run lisa_setnames_ver2 first. ;
% run lisa_xdropextract_ver2 first. ;
% run lisa_loadmdsfambim_ver2 first. ;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% ;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% ;
% check to make sure that the mr_A_full lines up with the mr_A_%0.2d ;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% ;
mr_A_ = cell(n_study,1);
mr_Z_ = cell(n_study,1);
for ns=1:n_study;
tmpchar = sprintf('%s/%s_mr_A_%0.2d.b16',dir__in,string_prefix,ns);
[~,nrows,ncols] = tutorial_binary_getsize(tmpchar);
mr_A_{ns} = (tutorial_binary_uncompress(tmpchar,1:nrows,1:ncols)>0);
tmpchar = sprintf('%s/%s_mr_Z_%0.2d.b16',dir__in,string_prefix,ns);
[~,nrows,ncols] = tutorial_binary_getsize(tmpchar);
mr_Z_{ns} = (tutorial_binary_uncompress(tmpchar,1:nrows,1:ncols)>0);
end;%for ns=1:n_study;
tmpchar = sprintf('%s/%s_mr_A_full.b16',dir__in,string_prefix);
[~,nrows,ncols] = tutorial_binary_getsize(tmpchar);
mr_A_full = (tutorial_binary_uncompress(tmpchar,1:nrows,1:ncols)>0);
tmpchar = sprintf('%s/%s_mr_Z_full.b16',dir__in,string_prefix);
[~,nrows,ncols] = tutorial_binary_getsize(tmpchar);
mr_Z_full = (tutorial_binary_uncompress(tmpchar,1:nrows,1:ncols)>0);
mr_A_tmp = []; mr_Z_tmp = [];
for ns=1:n_study;
mr_A_tmp = [mr_A_tmp;mr_A_{ns}];
mr_Z_tmp = [mr_Z_tmp;mr_Z_{ns}];
end;% for ns=1:n_study;
disp(sprintf(' %% mr_A error %0.16f',norm(mr_A_tmp-mr_A_full)));
disp(sprintf(' %% mr_Z error %0.16f',norm(mr_Z_tmp-mr_Z_full)));
