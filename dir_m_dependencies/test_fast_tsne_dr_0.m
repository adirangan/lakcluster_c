
set(gcf,'Position',1+[0,0,1024*1.5,1024*0.75]);
subplot(1,3,1);
cla; hold on;
plot([0,1],[0,1],'k-');plot([0.5,0.5],[0,1],'k-');plot([0,1],[0.5,0.5],'k-');
grid on;xlim([0.35,1]);ylim([0.35,1]);axis square;xlabel('spectral');ylabel('dexcluster');
title('Auc for dexcluster vs spectral');
subplot(1,3,2);
cla; hold on;
plot([0,1],[0,1],'k-');plot([0.5,0.5],[0,1],'k-');plot([0,1],[0.5,0.5],'k-');
grid on;xlim([0.35,1]);ylim([0.35,1]);axis square;xlabel('tsne');ylabel('spectral');
title('Auc for spectral vs tsne');
subplot(1,3,3);
cla; hold on;
plot([0,1],[0,1],'k-');plot([0.5,0.5],[0,1],'k-');plot([0,1],[0.5,0.5],'k-');
grid on;xlim([0.35,1]);ylim([0.35,1]);axis square;xlabel('tsne');ylabel('dexcluster');
title('Auc for dexcluster vs tsne');
%%%%%%%%;
c_ = colormap(colormap_beach());
X_ = linspace(0.5,0.75,6); n_X = length(X_); c_X_ = c_(round(linspace(1,size(c_,1),n_X)),:);
mu_ = linspace(0.2,1.0,5); n_mu = length(mu_); str_mu_ = {'o','^','s','p','h'};
n_iteration = 4;
for nX=1:n_X;
X = X_(nX);
for nmu=1:n_mu;
mu = mu_(nmu);
for niteration=1:n_iteration;
%rng(1);
%M=1780; N=1e4; gamma = 0.05;
%M=178; N=1e3; gamma = 0.05;
M=178*5; N=1e3*5; gamma = 0.05;
MX = ceil(M^X); NX = ceil(N^X);
A = randn(M,N); B=randn(MX,NX)+mu*ones(MX,1)*(2*(rand(1,NX)>0.5) - 1); 
for nj=1:2; 
pf_{nj} = randperm(size(A,nj)); 
[~,pi_{nj}] = sort(pf_{nj}); [~,pi_{nj}] = sort(pi_{nj}); 
end;% for nj=1:2;
A(pf_{1}(1:MX),pf_{2}(1:NX)) = B;
%%%%%%%%;
% Binarize? ;
%%%%%%%%;
% A = 2*(A>0)-1;
%%%%%%%%;
tic; [tmp_U_,tmp_S_,tmp_V_] = svds(A,1); t_s_ = toc;
[~,tmp_U_ij_] = sort(abs(tmp_U_),'descend'); [~,tmp_V_ij_] = sort(abs(tmp_V_),'descend');
rkeep_s_ = tmp_U_ij_; ckeep_s_ = tmp_V_ij_;
[~,tmp_Bn_] = intersect(rkeep_s_,pi_{1}(1:size(B,1)),'stable'); [~,tmp_Bc_] = intersect(rkeep_s_,pi_{1}(size(B,1)+1:end),'stable'); Auc_s_(1) = auc_0(tmp_Bn_,tmp_Bc_);
[~,tmp_Bn_] = intersect(ckeep_s_,pi_{2}(1:size(B,2)),'stable'); [~,tmp_Bc_] = intersect(ckeep_s_,pi_{2}(size(B,2)+1:end),'stable'); Auc_s_(2) = auc_0(tmp_Bn_,tmp_Bc_);
Auc_s_avg = mean(Auc_s_); disp(sprintf(' %% spectral   t%4.2f [%0.2f %0.2f] --> %0.2f',t_s_,Auc_s_,Auc_s_avg));
%%%%%%%%;
tic; out_xdrop_m_ = dexcluster_nonbinary_AAAA_ver0(A,gamma); t_m_ = toc;
rdrop_m_ = out_xdrop_m_(:,1); rdrop_m_ = 1+rdrop_m_(find(rdrop_m_>-1)); 
cdrop_m_ = out_xdrop_m_(:,2); cdrop_m_ = 1+cdrop_m_(find(cdrop_m_>-1)); 
rkeep_m_ = rdrop_m_(end:-1:1); ckeep_m_ = cdrop_m_(end:-1:1);
[~,tmp_Bn_] = intersect(rkeep_m_,pi_{1}(1:size(B,1)),'stable'); [~,tmp_Bc_] = intersect(rkeep_m_,pi_{1}(size(B,1)+1:end),'stable'); Auc_m_(1) = auc_0(tmp_Bn_,tmp_Bc_);
[~,tmp_Bn_] = intersect(ckeep_m_,pi_{2}(1:size(B,2)),'stable'); [~,tmp_Bc_] = intersect(ckeep_m_,pi_{2}(size(B,2)+1:end),'stable'); Auc_m_(2) = auc_0(tmp_Bn_,tmp_Bc_);
Auc_m_avg = mean(Auc_m_); disp(sprintf(' %% dexcluster t%4.2f [%0.2f %0.2f] --> %0.2f',t_m_,Auc_m_,Auc_m_avg));
%%%%%%%%;
tic; tsne_ord1_ = fast_tsne(A,struct('rand_seed',niteration,'no_dims',1)); t_m_ = toc;
Auc_t_avg = auc_0(tsne_ord1_(pi_{1}(1:MX)),tsne_ord1_(pi_{1}(MX+1:M))); Auc_t_avg = max(Auc_t_avg,1-Auc_t_avg);
flag_plot=0;
if flag_plot;
clf;
hold on; 
plot(1:MX,tsne_ord1_(pi_{1}(1:MX),1),'r.','MarkerSize',25);
plot(MX+1:M,tsne_ord1_(pi_{1}(MX+1:end),1),'b.','MarkerSize',15);
hold off;
end;%if flag_plot;
%{
% try mu=1.2; X=0.62.; 
tic; tsne_ord2_ = fast_tsne(A,struct('rand_seed',niteration,'no_dims',2,'theta',0)); t_m_ = toc;
flag_plot=1;
if flag_plot;
clf;
 subplot(1,2,1);
hold on; 
plot(tsne_ord2_(pi_{1}(1:MX),1),tsne_ord2_(pi_{1}(1:MX),2),'r.','MarkerSize',25);
plot(tsne_ord2_(pi_{1}(MX+1:end),1),tsne_ord2_(pi_{1}(MX+1:end),2),'b.','MarkerSize',15);
hold off;
idx2 = kmeans(tsne_ord2_(:,1:2),2);
 subplot(1,2,2);
gscatter(tsne_ord2_(:,1),tsne_ord2_(:,2),idx2);
end;%if flag_plot;
 %}
%%%%%%%%;
flag_plot=0;
if flag_plot;
colormap(colormap_beach());
subplot(1,3,1); imagesc(A(pi_{1},pi_{2}),[-1,1]); set(gca,'XTick',[],'Ytick',[]); title('A orig');
subplot(1,3,2); imagesc(A(rkeep_s_,ckeep_s_),[-1,1]); set(gca,'XTick',[],'Ytick',[]); title(sprintf('spectral A%0.2f',Auc_s_avg));
subplot(1,3,3); imagesc(A(rkeep_m_,ckeep_m_),[-1,1]); set(gca,'XTick',[],'Ytick',[]); title(sprintf('dexcluster A%0.2f',Auc_m_avg));
set(gcf,'Position',1+[0,0,1024,512]);
end;%if flag_plot;
%%%%%%%%;
subplot(1,3,1);hold on; plot(Auc_s_avg,Auc_m_avg,str_mu_{nmu},'Color',c_X_(nX,:)); 
subplot(1,3,2);hold on; plot(Auc_t_avg,Auc_s_avg,str_mu_{nmu},'Color',c_X_(nX,:)); 
subplot(1,3,3);hold on; plot(Auc_t_avg,Auc_m_avg,str_mu_{nmu},'Color',c_X_(nX,:)); 
drawnow();
end;%for niteration=1:n_iteration;
end;%for nmu=1:n_mu;
end;%for nX=1:n_X;
hold off; 
disp('returning');return;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%;
