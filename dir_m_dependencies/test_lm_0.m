%%%%%%%%;
% does a simple linear model (e.g., least-squares regression) ;
% capture effect-size as well as simple averaging?
%%%%%%%%;
clear;setup;rng(1);
n_A = 25; n_B = round(2*n_A); n_N = 4500;
%mu_ = transpose(sin(pi/2 * linspace(-1,+1,n_N)).^5); %<-- effect size. ;
mu_ = transpose(linspace(-1,+1,n_N)); %<-- effect size. ;
sg_ = [0;transpose(2.^[-4:0.5:4])]; %<-- noise level. ;
n_sg = length(sg_);
X_L_ = zeros(n_sg,1); %<-- correlation between xn_T_ and xn_L_ (i.e., least-squares regression coefficients). ;
X_M_ = zeros(n_sg,1); %<-- correlation between xn_T_ and xn_M_ (i.e., mean). ;
X_K_ = zeros(n_sg,1); %<-- condition number of matrix. ;
%%%%%%%%;
for nsg=1:n_sg;
sg = sg_(nsg);
An_ = [ sg*randn(n_A,n_N) + repmat(transpose(mu_)/2,n_A,1) ];
Bn_ = [ sg*randn(n_B,n_N) - repmat(transpose(mu_)/2,n_B,1) ];
Cn_ = [ ones(n_A,1) , An_ ; ones(n_B,1) , Bn_];
X_K_(nsg) = cond(Cn_);
%%%%%%%%;
bb_ = [2*ones(n_A,1) ; 1*ones(n_B,1)]; %<-- labels. ; 
bn_ = bb_ - mean(bb_); %<-- centered labels. ; 
%[xn_,nb] = conjgrad_0(Cn_,bb_,zeros(1+n_N,1));
[xn_,nb] = conjgrad_0(Cn_,bn_,zeros(1+n_N,1));
%%%%%%%%;
xn_T_ = mu_ ; %<-- true effect size. ; 
xn_1 = xn_(1); xn_L_ = xn_(1 + (1:n_N)); %<-- estimate from least-squares. ;
xn_M_ = transpose(mean(An_,1)-mean(Bn_,1)); %<-- estimate from mean. ;
%%%%%%%%;
X_L_(nsg) = corr(xn_T_,xn_L_);
X_M_(nsg) = corr(xn_T_,xn_M_);
end;%for nsg=1:n_sg;
%%%%%%%%;
%plotdisp_0(sg_,X_L_);plotdisp_0(sg_,X_M_);
X_D_ = X_M_ - X_L_;
disp(table(sg_,X_K_,X_L_,X_M_,X_D_));
