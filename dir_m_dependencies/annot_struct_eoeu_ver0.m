function annot = annot_struct_eoeu_ver0(annot);
n_ru = annot.n_ru;
ln_ = annot.ln_;
ru_ = annot.ru_;

%%%%%%%%;
eo__ = cell(n_ru,1);
for nru=1:n_ru;
tmp_ = zeros(ln_(nru),1);
for nln=1:ln_(nru);
tmp_(nln) = str2num(annot.EZ__{nru}{nln});
end;%for nln=1:ln_(nru);
eo__{nru} = tmp_;
end;%for nru=1:n_ru;
%%%%%%%%;
eu_max = 0; for nru=1:n_ru; eu_max = max(eu_max,max(eo__{nru})); end;
n_ln = sum(ln_);
ru_to_eo_ = zeros(n_ln,1);
eo_ = zeros(n_ln,1);
n_tmp = 0;
for nru=1:n_ru;
nln = ln_(nru);
tmp_ij_ = n_tmp + (1:nln);
ru_to_eo_(tmp_ij_) = nru;
eo_(tmp_ij_) = eo__{nru};
n_tmp = n_tmp + nln;
end;%for nru=1:n_ru;
%%%%%%%%;
%%%%%%%%;
% eu_ is an array of unique EZids drawn from eo_. ;
% ru_by_eu_xref_ is a sparse matrix with rows indexing ru_, columns indexing eu_, ;
% and sparse entries indicating which snps are associated with which genes. ;
%%%%%%%%;
[eu_,eo_to_eu_,eu_to_eo_] = unique(eo_);
ru_by_eu_xref_ = sparse(ru_to_eo_,eu_to_eo_,1); %<-- Now ru_by_eu_xref_ can be used to cross-reference snps and genes. ;
% i.e., if a list of EZids from eo_ is given by eu_(neu_), then nru_ = find(sum(ru_by_eu_xref_(:,neu_),2)) can be used to find the snps associated with those EZids. ;
% More specifically, ru_{nru_} lists the (string) rsids such that each of the eo__{nru_(nl)} lists a set of EZids such that at least one is within the original list from eu_(neu_). ;
flag_test=0;
if flag_test;
neu_ = randperm(length(eu_)); neu_ = neu_(1:floor(end/30));
nru_ = find(sum(ru_by_eu_xref_(:,neu_),2)); 
for nl=1:length(nru_);
nru = nru_(nl);
assert(length(intersect(eo__{nru},eu_(neu_)))>0);
end;%for nl=1:length(nru_);
end;%if flag_test;
%%%%%%%%;
% now check;
%%%%%%%%;
flag_test=0;
if flag_test;
h_s2_ = hist(sum(ru_by_eu_xref_,2),1:44); 
h_s1_ = hist(sum(ru_by_eu_xref_,1),1:1024);
subplot(1,2,1); stairs(h_s2_); title('number of eu per ru'); %<-- Seems like, on average, eash snp is referenced by 2-3 genes. ;
subplot(1,2,2); stairs(h_s1_); title('number of ru per eu');  %<-- Seems like, on average, each gene is referenced by 35-40 snps. ;
end;%if flag_test;

annot.eo__ = eo__;
annot.eu_max = eu_max;
annot.eo_ = eo_;
annot.ru_to_eo_ = ru_to_eo_;
annot.eu_ = eu_;
annot.eo_to_eu_ = eo_to_eu_;
annot.eu_to_eo_ = eu_to_eo_;
annot.ru_by_eu_xref_ = ru_by_eu_xref_;


