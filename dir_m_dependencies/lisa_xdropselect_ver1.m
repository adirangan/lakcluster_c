%Now extracting snp- and patient-list from bc1 cl4 20180304. ;
%%%%%%%%;
clear;
load('/data/rangan/dir_bcc/dir_PGC_20180304/mds.mat');
%%%%%%%%;
fname = '/data/rangan/dir_bcc/dir_PGC_20180304/dir_PGC_cl4_maf01_analyze/dir_PGC_cl4_maf01_dex_p25_D_m2r2_g004/out_trace.txt';
fcheck(fname);
trace_ = textread(fname);
ni = 275; c_rem = trace_(ni,3); r_rem = trace_(ni,2);
%%%%%%%%;
fname = '/data/rangan/dir_bcc/dir_PGC_20180304/dir_PGC_cl4_maf01_analyze/dir_PGC_cl4_maf01_dex_p25_D_m2r2_g004/out_xdrop_a.txt';
fcheck(fname);
xdrop_a_ = textread(fname);
rdrop_a_ = xdrop_a_(:,1); rdrop_a_ = rdrop_a_(find(rdrop_a_>-1)); rdrop_a_ = rdrop_a_ + 1; rdrop_a_ = rdrop_a_(end:-1:1); rdrop_a_ = rdrop_a_(1:r_rem);
cdrop_a_ = xdrop_a_(:,2); cdrop_a_ = cdrop_a_(find(cdrop_a_>-1)); cdrop_a_ = cdrop_a_ + 1; cdrop_a_ = cdrop_a_(end:-1:1); cdrop_a_ = cdrop_a_(1:c_rem);
%%%%%%%%;
fname = '/data/rangan/dir_bcc/dir_PGC_20180304/dir_PGC_cl4_maf01/PGC_cl4_maf01_bim.ext';
fcheck(fname);
fid = fopen(fname);
bim_ = textscan(fid,'%d\t%s\t%d\t%d\t%c\t%c\t%s\t%f\t%f\t%f\t%f\n','headerlines',0); 
fclose(fid);
fname = '/data/rangan/dir_bcc/dir_PGC_20180304/dir_PGC_cl4_maf01_analyze/dir_PGC_cl4_maf01_dex_p25_D_m2r2_g004/PGC_cl4_maf01_dex_p25_D_m2r2_g004_out_cdrop_ni275.txt';
fid=fopen(fname,'w');
for nc=1:length(cdrop_a_);
na = cdrop_a_(nc);
fprintf(fid,'%d\t%s\t%d\t%d\t%c\t%c\t%s\t%f\t%f\t%f\t%f\n',bim_{1}(na),bim_{2}{na},bim_{3}(na),bim_{4}(na),bim_{5}(na),bim_{6}(na),bim_{7}{na},bim_{8}(na),bim_{9}(na),bim_{10}(na),bim_{11}(na));
end;%for nc=1:length(cdrop_a_);
fclose(fid);
disp(sprintf('%s',fname));
%%%%%%%%;
fname = '/data/rangan/dir_bcc/dir_PGC_20180304/dir_PGC_cl4_maf01/PGC_cl4_maf01_fam.ext';
fcheck(fname);
fid = fopen(fname);
fam_ = textscan(fid,'%s %s %s %s %d %d %s','headerlines',0); 
fclose(fid);
n_patient_F = length(fam_{1}); fam_name_ = cell(n_patient_F,1); 
for np=1:n_patient_F; fam_name_{np} = sprintf('%s%s%s',fam_{1}{np},'&',fam_{2}{np}); end;%for np=1:n_patient_F;
[~,ifam_,imds_] = intersect(fam_name_,mds_name_,'stable'); 
if (length(ifam_)<n_patient_F); disp('Warning! fam_name_ not a subset of mds_name_'); end; 
mds_sort_ = mds_(imds_,:);
fname = '/data/rangan/dir_bcc/dir_PGC_20180304/dir_PGC_cl4_maf01_analyze/dir_PGC_cl4_maf01_dex_p25_D_m2r2_g004/PGC_cl4_maf01_dex_p25_D_m2r2_g004_out_rdrop_ni275.txt';
fid=fopen(fname,'w');
for nr=1:length(rdrop_a_);
ma = rdrop_a_(nr);
fprintf(fid,'%s %s %s %s %d %d %s %0.16f %0.16f %0.16f %0.16f %0.16f %0.16f %0.16f %0.16f %0.16f %0.16f %0.16f %0.16f %0.16f %0.16f %0.16f %0.16f %0.16f %0.16f %0.16f %0.16f\n',fam_{1}{ma},fam_{2}{ma},fam_{3}{ma},fam_{4}{ma},fam_{5}(ma),fam_{6}(ma),fam_{7}{ma},mds_sort_(ma,:));
end;%for nr=1:length(rdrop_a_);
fclose(fid);
disp(sprintf('%s',fname));
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%;

%Now extracting snp- and patient-list from bc2 cl4 20180304. ;
%%%%%%%%;
clear;
load('/data/rangan/dir_bcc/dir_PGC_20180304/mds.mat');
%%%%%%%%;
fname = '/data/rangan/dir_bcc/dir_PGC_20180304/dir_PGC_cl4_maf01_analyze/dir_PGC_cl4_maf01_dex_p25_D_m2r2_g004_r1/out_trace.txt';
fcheck(fname);
trace_ = textread(fname);
ni = 275; c_rem = trace_(ni,3); r_rem = trace_(ni,2);
%%%%%%%%;
fname = '/data/rangan/dir_bcc/dir_PGC_20180304/dir_PGC_cl4_maf01_analyze/dir_PGC_cl4_maf01_dex_p25_D_m2r2_g004_r1/out_xdrop_a.txt';
fcheck(fname);
xdrop_a_ = textread(fname);
rdrop_a_ = xdrop_a_(:,1); rdrop_a_ = rdrop_a_(find(rdrop_a_>-1)); rdrop_a_ = rdrop_a_ + 1; rdrop_a_ = rdrop_a_(end:-1:1); rdrop_a_ = rdrop_a_(1:r_rem);
cdrop_a_ = xdrop_a_(:,2); cdrop_a_ = cdrop_a_(find(cdrop_a_>-1)); cdrop_a_ = cdrop_a_ + 1; cdrop_a_ = cdrop_a_(end:-1:1); cdrop_a_ = cdrop_a_(1:c_rem);
%%%%%%%%;
fname = '/data/rangan/dir_bcc/dir_PGC_20180304/dir_PGC_cl4_maf01/PGC_cl4_maf01_bim.ext';
fcheck(fname);
fid = fopen(fname);
bim_ = textscan(fid,'%d\t%s\t%d\t%d\t%c\t%c\t%s\t%f\t%f\t%f\t%f\n','headerlines',0); 
fclose(fid);
fname = '/data/rangan/dir_bcc/dir_PGC_20180304/dir_PGC_cl4_maf01_analyze/dir_PGC_cl4_maf01_dex_p25_D_m2r2_g004_r1/PGC_cl4_maf01_dex_p25_D_m2r2_g004_r1_out_cdrop_ni275.txt';
fid=fopen(fname,'w');
for nc=1:length(cdrop_a_);
na = cdrop_a_(nc);
fprintf(fid,'%d\t%s\t%d\t%d\t%c\t%c\t%s\t%f\t%f\t%f\t%f\n',bim_{1}(na),bim_{2}{na},bim_{3}(na),bim_{4}(na),bim_{5}(na),bim_{6}(na),bim_{7}{na},bim_{8}(na),bim_{9}(na),bim_{10}(na),bim_{11}(na));
end;%for nc=1:length(cdrop_a_);
fclose(fid);
disp(sprintf('%s',fname));
%%%%%%%%;
fname = '/data/rangan/dir_bcc/dir_PGC_20180304/dir_PGC_cl4_maf01/PGC_cl4_maf01_fam.ext';
fcheck(fname);
fid = fopen(fname);
fam_ = textscan(fid,'%s %s %s %s %d %d %s','headerlines',0); 
fclose(fid);
n_patient_F = length(fam_{1}); fam_name_ = cell(n_patient_F,1); 
for np=1:n_patient_F; fam_name_{np} = sprintf('%s%s%s',fam_{1}{np},'&',fam_{2}{np}); end;%for np=1:n_patient_F;
[~,ifam_,imds_] = intersect(fam_name_,mds_name_,'stable'); 
if (length(ifam_)<n_patient_F); disp('Warning! fam_name_ not a subset of mds_name_'); end; 
mds_sort_ = mds_(imds_,:);
fname = '/data/rangan/dir_bcc/dir_PGC_20180304/dir_PGC_cl4_maf01_analyze/dir_PGC_cl4_maf01_dex_p25_D_m2r2_g004_r1/PGC_cl4_maf01_dex_p25_D_m2r2_g004_r1_out_rdrop_ni275.txt';
fid=fopen(fname,'w');
for nr=1:length(rdrop_a_);
ma = rdrop_a_(nr);
fprintf(fid,'%s %s %s %s %d %d %s %0.16f %0.16f %0.16f %0.16f %0.16f %0.16f %0.16f %0.16f %0.16f %0.16f %0.16f %0.16f %0.16f %0.16f %0.16f %0.16f %0.16f %0.16f %0.16f %0.16f\n',fam_{1}{ma},fam_{2}{ma},fam_{3}{ma},fam_{4}{ma},fam_{5}(ma),fam_{6}(ma),fam_{7}{ma},mds_sort_(ma,:));
end;%for nr=1:length(rdrop_a_);
fclose(fid);
disp(sprintf('%s',fname));
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%;
