function dg_ = dgammaln(x_);
% derivative of gammaln. ;
% assumes that x_ is real and positive (preferably an integer). ;
if nargin<1;
x_ = [0:0.125:10];
dx = 1e-4;
g_ = gammaln(1+x_);
dg1_ = (gammaln(1+x_+dx) - gammaln(1+x_-dx))/(2*dx);
dg2_ = dgammaln(1+x_);
subplot(1,2,1);
hold on;
plot(1+x_,dg1_,'ro-');
plot(1+x_,dg2_,'bx-');
hold off;
xlabel('1+x'); ylabel('d(gammaln)/dx'); title('derivative of gammaln(1+x)');
legend({'exact','approx'},'Location','NorthWest');
subplot(1,2,2);
hold on;
plot(1+x_,dg1_-dg2_,'k.-');
hold off;
xlabel('1+x'); ylabel('error'); title('error in derivative');
figbig;
disp('returning');return;
end;%if nargin<1;

dg_ = zeros(size(x_));
n_max = ceil(max(x_,[],'all'));
cs_ = cumsum([0,[1:n_max].^-1]) - euler_mascheroni();
dg_(:) = interp1([0:n_max],cs_,x_(:)-1,'spline');
