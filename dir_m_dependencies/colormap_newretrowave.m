function output = colormap_newretrowave(n_c,gamma1,gamma2,gamma3);
if (nargin<1); n_c = 64; end;
if (nargin<2); gamma1 = 0.50; end;
%if (nargin<2); gamma1 = 0.75; end;
if (nargin<3); gamma2 = 1.50; end;
%if (nargin<3); gamma2 = 0.75; end;
if (nargin<4); gamma3 = 0.25; end;

if n_c<0;
gamma1_ = linspace(0,2,9);
gamma2_ = linspace(0,2,9);
n_c = 64;
p_ = 0:n_c-1;
x_ = [0+p_;1+p_;1+p_;0+p_;0+p_];
y_ = repmat([0;0;1;1;0],[1,n_c]);
for ng1=0:8; for ng2=0:8;
gamma1 = gamma1_(1+ng1);
gamma2 = gamma2_(1+ng2);
subplot(9,9,1+ng1+ng2*9);
c_ = reshape(colormap_newretrowave(n_c,gamma1,gamma2),[1,n_c,3]);
p_ = patch(x_,y_,c_); set(p_,'EdgeColor','none');
title(sprintf('%0.2f %0.2f',gamma1,gamma2));
axisnotick;
end;end;%for ng1=0:8; for ng2=0:8;
figbig;
disp('returning'); return;
end;%if n_c<0;

c_ = zeros(n_c,3);
m1 = floor(n_c/2);
c_(m1,:) = [0,0,0];
tmp1_ = linspace(1,0,m1).^gamma1;
tmp2_ = linspace(1,0,m1).^gamma2;
tmp3_ = linspace(1,0,m1).^gamma3;
c_(1:m1,1) = 0 + 0*tmp3_;
c_(1:m1,2) = tmp2_;
c_(1:m1,3) = tmp1_;
m2 = ceil(n_c/2);
c_(m2,:) = [0,0,0];
tmp1_ = linspace(0,1,n_c-m2+1).^gamma1;
tmp2_ = linspace(0,1,n_c-m2+1).^gamma2;
tmp3_ = linspace(0,1,n_c-m2+1).^gamma3;
c_(m2:end,1) = tmp2_;
c_(m2:end,2) = 0 + 0*tmp3_;
c_(m2:end,3) = tmp1_;
output = c_;
