%%%%%%%%%%%%%%%%;
clear;clc;
verbose=1;
flag_platform = 2; 
if flag_platform==1; string_platform = '/home/arangan'; end; 
if flag_platform==2; string_platform = '/data/rangan/dir_bcc'; end; 
if flag_platform==3; string_platform = '/scratch/avr209'; end; 
dir_trunk = sprintf('%s/dir_PGC_20180304',string_platform); 
dir_code = sprintf('%s/dir_lakcluster_c_dev',string_platform);
%%%%%%%%%%%%%%%%;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%;

%%%%%%%%%%%%%%%%;
% /data/rangan/dir_bcc/dir_PGC_20180304/dir_PGC_cl1_maf01_analyze/dir_PGC_cl1_maf01_dex_p25_D_m2r2_g004/PGC_cl1_maf01_dex_p25_D_m2r2_g004_out_xdrop_ni375.txt
%%%%%%%%%%%%%%%%;
gamma=0.004; n_mds=20; B_MLT=34; flag_dex_vs_lak = {'dex'}; 
if (strcmp(flag_dex_vs_lak,'lak')); gamma = 0.001; mc_string = ''; else; gamma = 0.004; mc_string = ''; end;
flag_reverse = 0; cl_num = 1;
n_maf = 5; n_cov = 2;
n_shuffle = 0; n_scramble = 0; 
%%%%%%%%%%%%%%%%;
lisa_setprefix_ver2;
lisa_setnames_ver2;
lisa_xdropextract_ver2;
lisa_loadmdsfambim_ver2;
lisa_mxcheck_ver2;
lisa_studyindex_ver2;
lisa_traceextract_ver2;
%%%%%%%%%%%%%%%%;
niteration = 375; 
r_rem = r_rem_(niteration); c_rem = c_rem_(niteration);
rdrop_a_rem_ = rdrop_a_(end-r_rem+1:end); cdrop_a_rem_ = cdrop_a_(end-c_rem+1:end);
%%%%%%%%;
scramble_out_xdrop = zeros(r_rem + c_rem,2);
scramble_out_xdrop(1:r_rem,1) = rdrop_a_rem_(:);
scramble_out_xdrop(r_rem + (1:c_rem),2) = cdrop_a_rem_(:);
fname = sprintf('%s/%s_out_xdrop_ni%d.txt',dir_out_s0000,string_name_s0000,niteration);
fp = fopen(fname,'w'); fprintf(fp,'%d %d\n',transpose(scramble_out_xdrop-1)); fclose(fp);
disp(sprintf(' %% printed to:\n%s\n',fname));

%%%%%%%%%%%%%%%%;
% /data/rangan/dir_bcc/dir_PGC_20180304/dir_PGC_cl2_maf01_analyze/dir_PGC_cl2_maf01_dex_p25_D_m2r2_g004/PGC_cl2_maf01_dex_p25_D_m2r2_g004_out_xdrop_ni400.txt
%%%%%%%%%%%%%%%%;
gamma=0.004; n_mds=20; B_MLT=34; flag_dex_vs_lak = {'dex'}; 
if (strcmp(flag_dex_vs_lak,'lak')); gamma = 0.001; mc_string = ''; else; gamma = 0.004; mc_string = ''; end;
flag_reverse = 0; cl_num = 2;
n_maf = 5; n_cov = 2;
n_shuffle = 0; n_scramble = 0; 
%%%%%%%%%%%%%%%%;
lisa_setprefix_ver2;
lisa_setnames_ver2;
lisa_xdropextract_ver2;
lisa_loadmdsfambim_ver2;
lisa_mxcheck_ver2;
lisa_studyindex_ver2;
lisa_traceextract_ver2;
%%%%%%%%%%%%%%%%;
niteration = 400; 
r_rem = r_rem_(niteration); c_rem = c_rem_(niteration);
rdrop_a_rem_ = rdrop_a_(end-r_rem+1:end); cdrop_a_rem_ = cdrop_a_(end-c_rem+1:end);
%%%%%%%%;
scramble_out_xdrop = zeros(r_rem + c_rem,2);
scramble_out_xdrop(1:r_rem,1) = rdrop_a_rem_(:);
scramble_out_xdrop(r_rem + (1:c_rem),2) = cdrop_a_rem_(:);
fname = sprintf('%s/%s_out_xdrop_ni%d.txt',dir_out_s0000,string_name_s0000,niteration);
fp = fopen(fname,'w'); fprintf(fp,'%d %d\n',transpose(scramble_out_xdrop-1)); fclose(fp);
disp(sprintf(' %% printed to:\n%s\n',fname));

%%%%%%%%%%%%%%%%;
% /data/rangan/dir_bcc/dir_PGC_20180304/dir_PGC_cl3_maf01_analyze/dir_PGC_cl3_maf01_dex_p25_D_m2r2_g004/PGC_cl3_maf01_dex_p25_D_m2r2_g004_out_xdrop_ni400.txt
%%%%%%%%%%%%%%%%;
gamma=0.004; n_mds=20; B_MLT=34; flag_dex_vs_lak = {'dex'}; 
if (strcmp(flag_dex_vs_lak,'lak')); gamma = 0.001; mc_string = ''; else; gamma = 0.004; mc_string = ''; end;
flag_reverse = 0; cl_num = 3;
n_maf = 5; n_cov = 2;
n_shuffle = 0; n_scramble = 0; 
%%%%%%%%%%%%%%%%;
lisa_setprefix_ver2;
lisa_setnames_ver2;
lisa_xdropextract_ver2;
lisa_loadmdsfambim_ver2;
lisa_mxcheck_ver2;
lisa_studyindex_ver2;
lisa_traceextract_ver2;
%%%%%%%%%%%%%%%%;
niteration = 400; 
r_rem = r_rem_(niteration); c_rem = c_rem_(niteration);
rdrop_a_rem_ = rdrop_a_(end-r_rem+1:end); cdrop_a_rem_ = cdrop_a_(end-c_rem+1:end);
%%%%%%%%;
scramble_out_xdrop = zeros(r_rem + c_rem,2);
scramble_out_xdrop(1:r_rem,1) = rdrop_a_rem_(:);
scramble_out_xdrop(r_rem + (1:c_rem),2) = cdrop_a_rem_(:);
fname = sprintf('%s/%s_out_xdrop_ni%d.txt',dir_out_s0000,string_name_s0000,niteration);
fp = fopen(fname,'w'); fprintf(fp,'%d %d\n',transpose(scramble_out_xdrop-1)); fclose(fp);
disp(sprintf(' %% printed to:\n%s\n',fname));

%%%%%%%%%%%%%%%%;
% /data/rangan/dir_bcc/dir_PGC_20180304/dir_PGC_cl4_maf01_analyze/dir_PGC_cl4_maf01_dex_p25_D_m2r2_g004/PGC_cl4_maf01_dex_p25_D_m2r2_g004_out_xdrop_ni275.txt
%%%%%%%%%%%%%%%%;
gamma=0.004; n_mds=20; B_MLT=34; flag_dex_vs_lak = {'dex'}; 
if (strcmp(flag_dex_vs_lak,'lak')); gamma = 0.001; mc_string = ''; else; gamma = 0.004; mc_string = ''; end;
flag_reverse = 0; cl_num = 4;
n_maf = 5; n_cov = 2;
n_shuffle = 0; n_scramble = 0; 
%%%%%%%%%%%%%%%%;
lisa_setprefix_ver2;
lisa_setnames_ver2;
lisa_xdropextract_ver2;
lisa_loadmdsfambim_ver2;
lisa_mxcheck_ver2;
lisa_studyindex_ver2;
lisa_traceextract_ver2;
%%%%%%%%%%%%%%%%;
niteration = 275; 
r_rem = r_rem_(niteration); c_rem = c_rem_(niteration);
rdrop_a_rem_ = rdrop_a_(end-r_rem+1:end); cdrop_a_rem_ = cdrop_a_(end-c_rem+1:end);
%%%%%%%%;
scramble_out_xdrop = zeros(r_rem + c_rem,2);
scramble_out_xdrop(1:r_rem,1) = rdrop_a_rem_(:);
scramble_out_xdrop(r_rem + (1:c_rem),2) = cdrop_a_rem_(:);
fname = sprintf('%s/%s_out_xdrop_ni%d.txt',dir_out_s0000,string_name_s0000,niteration);
fp = fopen(fname,'w'); fprintf(fp,'%d %d\n',transpose(scramble_out_xdrop-1)); fclose(fp);
disp(sprintf(' %% printed to:\n%s\n',fname));

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%;

%%%%%%%%%%%%%%%%;
% /data/rangan/dir_bcc/dir_PGC_20180304/dir_PGC_cl1_maf01_analyze/dir_PGC_cl1_maf01_dex_p25_X_m2r2_g004/PGC_cl1_maf01_dex_p25_X_m2r2_g004_out_xdrop_ni400.txt
%%%%%%%%%%%%%%%%;
gamma=0.004; n_mds=20; B_MLT=34; flag_dex_vs_lak = {'dex'}; 
if (strcmp(flag_dex_vs_lak,'lak')); gamma = 0.001; mc_string = ''; else; gamma = 0.004; mc_string = ''; end;
flag_reverse = 1; cl_num = 1;
n_maf = 5; n_cov = 2;
n_shuffle = 0; n_scramble = 0; 
%%%%%%%%%%%%%%%%;
lisa_setprefix_ver2;
lisa_setnames_ver2;
lisa_xdropextract_ver2;
lisa_loadmdsfambim_ver2;
lisa_mxcheck_ver2;
lisa_studyindex_ver2;
lisa_traceextract_ver2;
%%%%%%%%%%%%%%%%;
niteration = 400; 
r_rem = r_rem_(niteration); c_rem = c_rem_(niteration);
rdrop_a_rem_ = rdrop_a_(end-r_rem+1:end); cdrop_a_rem_ = cdrop_a_(end-c_rem+1:end);
%%%%%%%%;
scramble_out_xdrop = zeros(r_rem + c_rem,2);
scramble_out_xdrop(1:r_rem,1) = rdrop_a_rem_(:);
scramble_out_xdrop(r_rem + (1:c_rem),2) = cdrop_a_rem_(:);
fname = sprintf('%s/%s_out_xdrop_ni%d.txt',dir_out_s0000,string_name_s0000,niteration);
fp = fopen(fname,'w'); fprintf(fp,'%d %d\n',transpose(scramble_out_xdrop-1)); fclose(fp);
disp(sprintf(' %% printed to:\n%s\n',fname));

%%%%%%%%%%%%%%%%;
% /data/rangan/dir_bcc/dir_PGC_20180304/dir_PGC_cl2_maf01_analyze/dir_PGC_cl2_maf01_dex_p25_X_m2r2_g004/PGC_cl2_maf01_dex_p25_X_m2r2_g004_out_xdrop_ni450.txt
%%%%%%%%%%%%%%%%;
gamma=0.004; n_mds=20; B_MLT=34; flag_dex_vs_lak = {'dex'}; 
if (strcmp(flag_dex_vs_lak,'lak')); gamma = 0.001; mc_string = ''; else; gamma = 0.004; mc_string = ''; end;
flag_reverse = 1; cl_num = 2;
n_maf = 5; n_cov = 2;
n_shuffle = 0; n_scramble = 0; 
%%%%%%%%%%%%%%%%;
lisa_setprefix_ver2;
lisa_setnames_ver2;
lisa_xdropextract_ver2;
lisa_loadmdsfambim_ver2;
lisa_mxcheck_ver2;
lisa_studyindex_ver2;
lisa_traceextract_ver2;
%%%%%%%%%%%%%%%%;
niteration = 450; 
r_rem = r_rem_(niteration); c_rem = c_rem_(niteration);
rdrop_a_rem_ = rdrop_a_(end-r_rem+1:end); cdrop_a_rem_ = cdrop_a_(end-c_rem+1:end);
%%%%%%%%;
scramble_out_xdrop = zeros(r_rem + c_rem,2);
scramble_out_xdrop(1:r_rem,1) = rdrop_a_rem_(:);
scramble_out_xdrop(r_rem + (1:c_rem),2) = cdrop_a_rem_(:);
fname = sprintf('%s/%s_out_xdrop_ni%d.txt',dir_out_s0000,string_name_s0000,niteration);
fp = fopen(fname,'w'); fprintf(fp,'%d %d\n',transpose(scramble_out_xdrop-1)); fclose(fp);
disp(sprintf(' %% printed to:\n%s\n',fname));

%%%%%%%%%%%%%%%%;
% /data/rangan/dir_bcc/dir_PGC_20180304/dir_PGC_cl3_maf01_analyze/dir_PGC_cl3_maf01_dex_p25_X_m2r2_g004/PGC_cl3_maf01_dex_p25_X_m2r2_g004_out_xdrop_ni450.txt
%%%%%%%%%%%%%%%%;
gamma=0.004; n_mds=20; B_MLT=34; flag_dex_vs_lak = {'dex'}; 
if (strcmp(flag_dex_vs_lak,'lak')); gamma = 0.001; mc_string = ''; else; gamma = 0.004; mc_string = ''; end;
flag_reverse = 1; cl_num = 3;
n_maf = 5; n_cov = 2;
n_shuffle = 0; n_scramble = 0; 
%%%%%%%%%%%%%%%%;
lisa_setprefix_ver2;
lisa_setnames_ver2;
lisa_xdropextract_ver2;
lisa_loadmdsfambim_ver2;
lisa_mxcheck_ver2;
lisa_studyindex_ver2;
lisa_traceextract_ver2;
%%%%%%%%%%%%%%%%;
niteration = 450; 
r_rem = r_rem_(niteration); c_rem = c_rem_(niteration);
rdrop_a_rem_ = rdrop_a_(end-r_rem+1:end); cdrop_a_rem_ = cdrop_a_(end-c_rem+1:end);
%%%%%%%%;
scramble_out_xdrop = zeros(r_rem + c_rem,2);
scramble_out_xdrop(1:r_rem,1) = rdrop_a_rem_(:);
scramble_out_xdrop(r_rem + (1:c_rem),2) = cdrop_a_rem_(:);
fname = sprintf('%s/%s_out_xdrop_ni%d.txt',dir_out_s0000,string_name_s0000,niteration);
fp = fopen(fname,'w'); fprintf(fp,'%d %d\n',transpose(scramble_out_xdrop-1)); fclose(fp);
disp(sprintf(' %% printed to:\n%s\n',fname));

%%%%%%%%%%%%%%%%;
% /data/rangan/dir_bcc/dir_PGC_20180304/dir_PGC_cl4_maf01_analyze/dir_PGC_cl4_maf01_dex_p25_X_m2r2_g004/PGC_cl4_maf01_dex_p25_X_m2r2_g004_out_xdrop_ni300.txt
%%%%%%%%%%%%%%%%;
gamma=0.004; n_mds=20; B_MLT=34; flag_dex_vs_lak = {'dex'}; 
if (strcmp(flag_dex_vs_lak,'lak')); gamma = 0.001; mc_string = ''; else; gamma = 0.004; mc_string = ''; end;
flag_reverse = 1; cl_num = 4;
n_maf = 5; n_cov = 2;
n_shuffle = 0; n_scramble = 0; 
%%%%%%%%%%%%%%%%;
lisa_setprefix_ver2;
lisa_setnames_ver2;
lisa_xdropextract_ver2;
lisa_loadmdsfambim_ver2;
lisa_mxcheck_ver2;
lisa_studyindex_ver2;
lisa_traceextract_ver2;
%%%%%%%%%%%%%%%%;
niteration = 300; 
r_rem = r_rem_(niteration); c_rem = c_rem_(niteration);
rdrop_a_rem_ = rdrop_a_(end-r_rem+1:end); cdrop_a_rem_ = cdrop_a_(end-c_rem+1:end);
%%%%%%%%;
scramble_out_xdrop = zeros(r_rem + c_rem,2);
scramble_out_xdrop(1:r_rem,1) = rdrop_a_rem_(:);
scramble_out_xdrop(r_rem + (1:c_rem),2) = cdrop_a_rem_(:);
fname = sprintf('%s/%s_out_xdrop_ni%d.txt',dir_out_s0000,string_name_s0000,niteration);
fp = fopen(fname,'w'); fprintf(fp,'%d %d\n',transpose(scramble_out_xdrop-1)); fclose(fp);
disp(sprintf(' %% printed to:\n%s\n',fname));


